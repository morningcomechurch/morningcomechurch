

<!doctype html>
<html lang="ko">
	<head>
		<meta charset="utf-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="온라인기도실편집기">
		<meta name="author" content="임현우">
		<meta name="generator" content="온라인 기도실">
		<!-- CSS only -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
		<!-- <link rel="stylesheet" href='./room.css'/> -->
		
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css">
		<!-- JS, Popper.js, and jQuery -->
		<script
		src="//code.jquery.com/jquery-3.5.1.min.js"
		integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
		crossorigin="anonymous"></script>
		
		<script   src="//code.jquery.com/ui/1.12.1/jquery-ui.min.js"   integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="  crossorigin="anonymous"></script>
		
		
		<!--
			<script src="//stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
			
			<script src="//cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
		-->
		
		
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
		
		
		
		<!-- JavaScript -->
		<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
		
		<!-- CSS -->
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
		
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.0/bootstrap-slider.min.js" integrity="sha512-ipipCzTL75eaZtDzsY/sAnzonwtbRzkXh3XFuL/bpQYCPgPXL9Sbar1fYO0kCG2lXGK3tIhymLBlb/O0C5+eTQ==" crossorigin="anonymous"></script>
		
		
		
		
		<script src="https://unpkg.com/@popperjs/core@2"></script>
		
		<!--	
			
			<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/css/bootstrap-slider.css" integrity="sha512-SZgE3m1he0aEF3tIxxnz/3mXu/u/wlMNxQSnE0Cni9j/O8Gs+TjM9tm1NX34nRQ7GiLwUEzwuE3Wv2FLz2667w==" crossorigin="anonymous" />
			
		-->
		
		<title>묵상 편집  신양교회</title>
	</head>
	<body>
		
		<style>
			
			
			.maincard {
			display:none;
			margin:0px;
			padding:0px;
			
			}
			.byline {
			visibility:hidden;
			}
			
			.allpage {
			display:none;
			}
			
			
			#main_fr {
			background-position:top center;
			background-size:contain;
			background-repeat:no-repeat;
			margin:0px;
			padding:0px;
			
			height: 850px;
			
			}
			
			.selbg {
			z-index:0;
			}
			.selbg:hover {
			transform: scale(2);
			z-index:100;
			}
			
			
			.smallpic {
			
			height:36px;
			width:auto;
			}
			
			.btn-first-menu {
			background-color: #ccc;
			
			}
			hr {
			background-color: #aaa;
			height: 2px; 
			} 
			
			hr.sm {
			background-color: #aaa;
			height: 1px; 
			} 
			
			
			#btn_next {
			font-weight:bold;
			
			}
			
			.colyel{
			color: #f5c842;
			}
			.onslide {
			font-size:14px;
						
			}
			
			
			@font-face {
			font-family: 'S-CoreDream-6Bold';
			src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/S-CoreDream-6Bold.woff') format('woff');
			font-weight: normal;
			font-style: normal;
			}
			
			#main_fr {
			
			font-family: 'S-CoreDream-6Bold';
			font-stretch: ultra-condensed;
			} 
			
							
				
				
				.incard {
				color:#fff;
				}
				
				li {
				font-size:18px;
				}
				
				
				.oneline {
				
				font-size: 24px;
				color: #ff00ff;
				font-weight:bold;
				border: none; 
				background: transparent;
				width:100%
				
				}
				.oneline:focus {
				font-size: 24px;
				color: #ff00ff;
				font-weight:bold;
				border: none; 
				background: transparent;
				outline:none;
				width:100%
				
				}
				
				
				
				@font-face { font-family: 'NotoSerifKR'; src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/NotoSerifKR.woff') format('woff'); font-weight: normal; font-style: normal; }
				
				#main_fr {
				
				font-family: 'NotoSerifKR';
				font-stretch: ultra-condensed;
				background-size:cover;
				}
				
				
							
			
		</style>
		<audio  id='aup0' src="" style='display:none' type="audio/mp3" ></audio> 
		
		<audio  id='aup1' src="" style='display:none' type="audio/mp3" ></audio> 
		
		<audio  id='aup2' src="" style='display:none' type="audio/mp3" ></audio> 
		
		<audio  id='aup3' src="" style='display:none' type="audio/mp3" ></audio> 
		
		<div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
			<h2 class="my-0 mr-md-auto font-weight-normal">묵상 편집기<sub id='now_title' style='font-size:14px;'></sub></h2>
			<nav class="my-2 my-md-0 mr-md-3">
				<a class="p-2 text-dark" onclick='save_to_db_newpost();'  data-toggle="tooltip"  title="새 이름으로 저장합니다.<br/> Alt+V" data-html="true"><kbd class='altk' style='display:none;background-color:#aaa'>V</kbd> 복사후 저장</a>
				
				<a class="p-2 text-dark" id='btn_load_project'>불러오기<kbd class='ctrlk' style='display:none;'>O</kbd></a>
				<a class="p-2 text-dark" onclick=" toggle_kbd_show();"><i class='bi-info-circle'></i>도움말</a>
				
				<!-- <a class="p-2 text-dark" href="#">내보내기</a>
					
					
					
				<!--  <a class="btn btn-outline-primary" href="#">Sign up</a>-->
			</nav>
		</div>
		
		<div class="container-fluid" > 
			<div   id='div_projects' >
				
			</div>
			<hr/>
			<div class="row ">
				
				<div class='col-lg-4 d-md-none d-lg-block' id='div_pan1'> 
					 
					<div  class='' style='display:none;'  id='div_bgm_list'>
					 


					</div>
					 
					
					<div class='tog_edit_icon' id='div_icon_list' style='display:none'>
						
						
					</div>
					<div class='tog_edit' id='div_picsel' style='display:none'>
						
						<h4 class='mt-4'> Unsplash 
							<button class='btn  btn-outline-info btn-sm' id='btn_new_unsplsh_user'>사용자</button>
							
							<button class='btn  btn-outline-info btn-sm' id='btn_new_unsplsh'>컬렉션</button>
							
						</h4> 
						<div id='undplash_user_list'></div>
						<div class='mt-2' id='div_collection_list'> </div>
						
						<div class='row no-gutter' id='div_unsplash'>
							
							
						</div>
						
						
						<h4 class='mt-4'>서버 이미지 <button class='btn btn-outline-info btn-sm' onclick="$(this).parent().next().toggle();">접기</button></h4>
						<div class='row no-gutter'>
							<div class='col-12'>0건 </div>						</div>
						
						<!-- <input id="ex1" data-slider-id='ex1Slider' type="text" data-slider-min="0" data-slider-max="20" data-slider-step="1" data-slider-value="14"/> -->
						
						
						
						
					</div>
					
					<p> 슬라이드 <a class='btn btn-outline-primary btn-sm' id='btn_load_db' data-toggle="tooltip"  title="DB에서 내용을 다시 불러옵니다.<br/> Ctrl+R" data-html="true"><i class='bi-arrow-counterclockwise'></i><kbd class='ctrlk' style='display:none;'>R</kbd> 새로  고침</a>
						<a class='btn btn-outline-danger btn-sm' id='btn_del_slide'><i class=' bi-trash mr-1'></i>슬라이드 삭제</a>  
					</p> 
					
					<ul class="list-group" id='sortable'>
													<li class="list-group-item onslide" data-sd='1' id='listslide1'>슬라이드1								
							</li>
													<li class="list-group-item onslide" data-sd='2' id='listslide2'>슬라이드2								
							</li>
													<li class="list-group-item onslide" data-sd='3' id='listslide3'>슬라이드3								
							</li>
													<li class="list-group-item onslide" data-sd='4' id='listslide4'>슬라이드4								
							</li>
													<li class="list-group-item onslide" data-sd='5' id='listslide5'>슬라이드5								
							</li>
													<li class="list-group-item onslide" data-sd='6' id='listslide6'>슬라이드6								
							</li>
													<li class="list-group-item onslide" data-sd='7' id='listslide7'>슬라이드7								
							</li>
													<li class="list-group-item onslide" data-sd='8' id='listslide8'>슬라이드8								
							</li>
													<li class="list-group-item onslide" data-sd='9' id='listslide9'>슬라이드9								
							</li>
													<li class="list-group-item onslide" data-sd='10' id='listslide10'>슬라이드10								
							</li>
													<li class="list-group-item onslide" data-sd='11' id='listslide11'>슬라이드11								
							</li>
													<li class="list-group-item onslide" data-sd='12' id='listslide12'>슬라이드12								
							</li>
													<li class="list-group-item onslide" data-sd='13' id='listslide13'>슬라이드13								
							</li>
													<li class="list-group-item onslide" data-sd='14' id='listslide14'>슬라이드14								
							</li>
													<li class="list-group-item onslide" data-sd='15' id='listslide15'>슬라이드15								
							</li>
													<li class="list-group-item onslide" data-sd='16' id='listslide16'>슬라이드16								
							</li>
													<li class="list-group-item onslide" data-sd='17' id='listslide17'>슬라이드17								
							</li>
													<li class="list-group-item onslide" data-sd='18' id='listslide18'>슬라이드18								
							</li>
													<li class="list-group-item onslide" data-sd='19' id='listslide19'>슬라이드19								
							</li>
													<li class="list-group-item onslide" data-sd='20' id='listslide20'>슬라이드20								
							</li>
													<li class="list-group-item onslide" data-sd='21' id='listslide21'>슬라이드21								
							</li>
													<li class="list-group-item onslide" data-sd='22' id='listslide22'>슬라이드22								
							</li>
													<li class="list-group-item onslide" data-sd='23' id='listslide23'>슬라이드23								
							</li>
													<li class="list-group-item onslide" data-sd='24' id='listslide24'>슬라이드24								
							</li>
													<li class="list-group-item onslide" data-sd='25' id='listslide25'>슬라이드25								
							</li>
													<li class="list-group-item onslide" data-sd='26' id='listslide26'>슬라이드26								
							</li>
													<li class="list-group-item onslide" data-sd='27' id='listslide27'>슬라이드27								
							</li>
													<li class="list-group-item onslide" data-sd='28' id='listslide28'>슬라이드28								
							</li>
													<li class="list-group-item onslide" data-sd='29' id='listslide29'>슬라이드29								
							</li>
													<li class="list-group-item onslide" data-sd='30' id='listslide30'>슬라이드30								
							</li>
													<li class="list-group-item onslide" data-sd='31' id='listslide31'>슬라이드31								
							</li>
													<li class="list-group-item onslide" data-sd='32' id='listslide32'>슬라이드32								
							</li>
													<li class="list-group-item onslide" data-sd='33' id='listslide33'>슬라이드33								
							</li>
													<li class="list-group-item onslide" data-sd='34' id='listslide34'>슬라이드34								
							</li>
													<li class="list-group-item onslide" data-sd='35' id='listslide35'>슬라이드35								
							</li>
													<li class="list-group-item onslide" data-sd='36' id='listslide36'>슬라이드36								
							</li>
													<li class="list-group-item onslide" data-sd='37' id='listslide37'>슬라이드37								
							</li>
													<li class="list-group-item onslide" data-sd='38' id='listslide38'>슬라이드38								
							</li>
													<li class="list-group-item onslide" data-sd='39' id='listslide39'>슬라이드39								
							</li>
													<li class="list-group-item onslide" data-sd='40' id='listslide40'>슬라이드40								
							</li>
													<li class="list-group-item onslide" data-sd='41' id='listslide41'>슬라이드41								
							</li>
													<li class="list-group-item onslide" data-sd='42' id='listslide42'>슬라이드42								
							</li>
													<li class="list-group-item onslide" data-sd='43' id='listslide43'>슬라이드43								
							</li>
													<li class="list-group-item onslide" data-sd='44' id='listslide44'>슬라이드44								
							</li>
													<li class="list-group-item onslide" data-sd='45' id='listslide45'>슬라이드45								
							</li>
													<li class="list-group-item onslide" data-sd='46' id='listslide46'>슬라이드46								
							</li>
													<li class="list-group-item onslide" data-sd='47' id='listslide47'>슬라이드47								
							</li>
													<li class="list-group-item onslide" data-sd='48' id='listslide48'>슬라이드48								
							</li>
													<li class="list-group-item onslide" data-sd='49' id='listslide49'>슬라이드49								
							</li>
													<li class="list-group-item onslide" data-sd='50' id='listslide50'>슬라이드50								
							</li>
													<li class="list-group-item onslide" data-sd='51' id='listslide51'>슬라이드51								
							</li>
													<li class="list-group-item onslide" data-sd='52' id='listslide52'>슬라이드52								
							</li>
													<li class="list-group-item onslide" data-sd='53' id='listslide53'>슬라이드53								
							</li>
													<li class="list-group-item onslide" data-sd='54' id='listslide54'>슬라이드54								
							</li>
													<li class="list-group-item onslide" data-sd='55' id='listslide55'>슬라이드55								
							</li>
													<li class="list-group-item onslide" data-sd='56' id='listslide56'>슬라이드56								
							</li>
													<li class="list-group-item onslide" data-sd='57' id='listslide57'>슬라이드57								
							</li>
													<li class="list-group-item onslide" data-sd='58' id='listslide58'>슬라이드58								
							</li>
													<li class="list-group-item onslide" data-sd='59' id='listslide59'>슬라이드59								
							</li>
													<li class="list-group-item onslide" data-sd='60' id='listslide60'>슬라이드60								
							</li>
												
					</ul>
					<a class='btn btn-sm btn-outline-info btn-block' id='btn_add_slide'>+ 슬라이드 추가</a>
				</div>
				
				
				<div class='col-md-6  col-lg-4' id='div_pan2'>
					<div class="alert alert-danger" role="alert" style='display:none;' id='div_alert'>
					<h4 class="alert-heading">음악관련 안내!</h4>
					 <hr>
음악을 설정하셨으나, 재생버튼을 설정하지 않았습니다.<br>
음악을 재생할 슬라이드 앞페이지에 <b><u onclick='void(0);' id='u_add_playmusic'>다음버튼함께음악1시작::다음</u></b> 을 넣으시길 바랍니다.
<button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
  
					</div>
					
					<h5>편집창 <a class='btn btn-info btn-sm' style='display:none' id='btn_view'>적용하기</a> 
						<a class='btn btn-primary btn-sm' id='btn_save_thisslide'><i class='selicon bi-download mr-1'></i><kbd class='ctrlk mr-1' style='display:none;'>S</kbd>저장</a> 
						
						
						
						<a class='btn btn-outline-info btn-sm' id='btn_view_new_window' href='http://ministry.ssch.net/us/room2021.html/'  target='_blank'><kbd class='ctrlk' style='display:none;'>N</kbd> 새창보기</a> 
						
						<!--						<a class='btn btn-outline-info btn-sm' id='btn_view_new_window' href='http://ministry.ssch.net/40days/room/'  target='_blank'><kbd class='ctrlk' style='display:none;'>N</kbd> 새창보기</a>  -->
						
						
						<button class='btn btn-sm btn-default btn-outline-info ' onclick="void(0);" id='btn_make_qr'  data-toggle="tooltip"  title="휴대폰에서 열수 있도록 QR코드를 보여줍니다.<br/> Ctrl+Q" data-html="true" >
							<i class='selicon bi-upc-scan'></i><kbd class='ctrlk' style='display:none;'>Q</kbd>QR
						</button>
						<a class='btn btn-outline-info btn-sm' id='btn_sel_icon' onclick='void(0);' ><i class='bi-emoji-smile'></i><kbd class='altk' style='display:none;background-color:#aaa'>I</kbd> Icon</a>  
						 
												
						
						
					</h5>	
					<div class='col-12'>
						<!-- 			
							e.value = e.value.slice(0,  e.selectionStart) + "INJECT STRING" + e.value.slice(e.selectionStart); 
							
							
							
							<i class='selicon bi-text-right'></i><i class='selicon bi-text-right'></i><i class='selicon bi-text-center'></i>
						-->
						
						
						<!--	
							<h6>스니펫 모음 </h6>
							<a class='m-1 snip'>큰본문::</a>
							<a class='m-1 snip'>중간본문::</a>
							<a class='m-1 snip'>작은본문::</a>
						-->
						
					</div>
					<div class='form-group'>
						
						<div class="btn-group" name='align_btn_groups'>
							<button type="button" class="btn btn-light btn-sm btn-first-menu" onclick=" " ><b>정렬</b> <kbd class='ctrlk' style='display:none;'>-</kbd></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" onclick="change_align_left();" id='btn_text_left'  ><i class=' bi-text-left'></i></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" onclick="change_align_middle();" id='btn_text_middle'><i class=' bi-text-center'></i></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" onclick="change_align_right();" id='btn_text_right'><i class=' bi-text-right'></i></button>
						</div> 
						<div class="btn-group" >
							<button type="button" class="btn btn-light btn-sm btn-first-menu" onclick=" " ><b>크기</b><kbd class='ctrlk' style='display:none;'>=</kbd></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" onclick="change_size_Tag_big();" id='btn_size_big'><i class=' bi-type-h1'></i></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" onclick="change_size_Tag_middle();" id='btn_size_middle'><i class=' bi-type-h2'></i></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" onclick="change_size_Tag_small();" id='btn_size_small'><i class=' bi-type-h3'></i></button>
						</div>
						<div class="btn-group" >
							<button type="button" class="btn btn-light btn-sm btn-first-menu" onclick=" " ><b>배경</b></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm"  id='btn_modal_pic' data-toggle="tooltip" data-placement="bottom"  title="배경을 선택합니다. <br/> Ctrl+B" data-html="true">기본<kbd class='ctrlk' style='display:none;'>B</kbd></button>
							<button type="button" class="btn btn-light  btn_menu_icon btn-sm" id='btn_modal_pic_desktop'>컴퓨터</button>
						</div>
						
						<button type="button" class="btn btn-warning btn-sm" onclick="void(0);" id="btn_sel_music" ><b>음악</b></button>
						<textarea class='form-control textarea' rows='30' id='editor'>
						</textarea>
					</div>
					
					
					
					
					
				</div>
				
				<div class="col-md-6  col-lg-4 "  >
					<div class="btn-group" >
						<button type="button" class="btn btn-info btn-sm" onclick=" " >화면비율</button>
						<button type="button" class="btn btn-light btn-sm btn_ratio" data-ratio='1.33'>3:4</button>
						<button type="button" class="btn btn-light btn-sm btn_ratio" data-ratio='1.78'>9:16</button>
						<button type="button" class="btn btn-light btn-sm btn_ratio" data-ratio='1'>1:1</button>
					</div>
					
					<div class="btn-group" id='btn_gr_change' >
						<a type="button" class="btn btn-info btn-sm "  ><i class=' bi-arrow-repeat'></i> 전환</a>
						
						
						<a class='btn btn-outline-info btn-sm' id='btn_change_div' data-change='0' style='display:none;'> 단락</a>  
						
						
						<a class='btn btn-sm btn_desktop_pic btn-outline-info'  id='btn_change_bg' style='display:none;' onclick="is_desktop_background=!is_desktop_background;$(this).toggleClass('btn-info').toggleClass('btn-outline-info');$('#btn_view').click();" >배경</a>
						
					</div>
										
					<div id='main_fr' style='position:relative;'>
						<div class='maincard'>
							
						</div>
					</div>
				</div>
				
				
			</div>
			
			<div style='display:none' id='alldata'>
				슬라이드::
				배경사진::http://ministry.ssch.net/prayer/bg3.jpg
				자료사진::../knee2.jpg
				===
				가운데제목::[기도]의 성벽을 재건하라
				가운데작은본문::2020년 9월 둘째 주 / 9월 13일(주일) ~ 9월 19일(토)
				===
				시작버튼::
				
				
				
				슬라이드::
				배경사진::http://ministry.ssch.net/prayer/bg3.jpg
				제목::온라인 [기도실] 안내
				===
				설명*::온라인 기도실은 홀로 하나님께 나아가는 자리입니다.
				설명*::30분 정도 여유를 갖고 하시길 바랍니다.
				설명*::말씀과 묵상, 찬양과 기도로 함께 합니다.
				설명*::배경 음악이 나올 수 있습니다. 볼륨을 조절하시기 바랍니다.
				줄바꿈::
				중간본문::준비가 되셨으면, 아래의 버튼을 눌러주세요. 
				줄바꿈::
				다음버튼::기도로 나아가며
			</div>
			
			
			
			<!--
				<div class="modal fade" id="modal_background_pic" tabindex="-1">
				<div class="modal-dialog  modal-xl">
				<div class="modal-content">
				<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">배경 선택</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
				</div>
				<div class="modal-body">
				<div class='row'>
				
				</div>
				</div>
				<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button>
				<button type="button" class="btn btn-primary">선택</button>
				</div>
				</div>
				</div>
				</div> 
			-->		
		</div> 
		
		<div class="modal fade" id="myModal2" tabindex="-1" role="dialog"  aria-hidden="true">
			<div class="modal-dialog  modal-sm">
				<div class="modal-content">
					아래 QR코드를 스캔하여 휴대폰에서 확인해 보세요.
					<center  id='div_qr'  >
						
					</center>
					
				</div>
			</div>
		</div>
		
		<!-- END OF ROW -->
		<!-- <div style='position: fixed; bottom: 50px; right: 10px; z-index:996;' id='div_line_move' > 
			<button type="button" class="btn btn-primary">선택</button>
		</div> -->
		<script>
			//('#c15').find("input[type='text']").eq(0).val("ddd")
			var isOnplay=false;
			var bgmList=["\uc608\uc218\ub098\ub97c \uc704\ud558\uc5ec, \ub098\uc758 \uac08 \uae38 \ub2e4\uac00\ub3c4\ub85d|https:\/\/pgsixt.github.io\/bgm\/20201206_prayer_bgm.mp3|\ud53c\uc544\ub178|5:44|\uc0b0\uc131\uad50\ud68c|\ud669\uc740\ud61c","\ubcc0\ucc2e\ub294 \uc8fc\ub2d8\uc758 \uc0ac\ub791\uacfc|https:\/\/pgsixt.github.io\/bgm\/20210719_prayer_bgm.mp3|\ud53c\uc544\ub178|2:00|\uc0b0\uc131\uad50\ud68c|\ud669\uc740\ud61c","\uadf8 \ucc38\ud639\ud55c \uc2ed\uc790\uac00\uc5d0|https:\/\/pgsixt.github.io\/bgm\/20210719_prayer_bgm2.mp3|\ud53c\uc544\ub178|1:50|\uc0b0\uc131\uad50\ud68c|\ud669\uc740\ud61c","\ub0a0\ub9c8\ub2e4 \uc228\uc26c\ub294 \uc21c\uac04\ub9c8\ub2e4, \ub0b4 \uc601\ud63c\uc774 \uc740\ucd1d\uc785\uc5b4 |https:\/\/pgsixt.github.io\/bgm\/20201115_prayer_bgm.mp3|\uc2e0\ub514|5:34|\uc0b0\uc131\uad50\ud68c|\ubc15\uacbd\uc120 \uc678","\uac08\ubcf4\ub9ac\uc0b0 \uc704\uc5d0, \uad34\ub85c\uc6b8 \ub54c \uc8fc\ub2d8\uc758 \uc5bc\uad74\ubcf4\ub77c|https:\/\/pgsixt.github.io\/bgm\/20201018_prayer_bgm.mp3|\uc2e0\ub514|6:25|\uc0b0\uc131\uad50\ud68c|\ubc15\uacbd\uc120 \uc678","\uac70\ub8e9\ud558\uc2e0 \ud558\ub098\ub2d8,\uad6c\uc8fc\ub97c \uc0dd\uac01\ub9cc \ud574\ub3c4 |https:\/\/pgsixt.github.io\/bgm\/20201003_prayer_bgm.mp3|\uc2e0\ub514|6:25|\uc0b0\uc131\uad50\ud68c|\ubc15\uacbd\uc120 \uc678","",""];
			bgmList=bgmList.filter(x=>x.length>0);
			
			
			
			
			var now_user_wp_id=5;
			
			
			var now_project_type='묵상';
			
			
			
			String.prototype.replaceAll = function(org, dest) {
				return this.split(org).join(dest);
			}
			
			
			var last_saved_data=[];
			
			var google_formdata={};
			
			var  unsplash_user_list={"ID":"1158","post_content":"lhw2020|guilhermestecanella|sirene"};
			var timerId_kbd_event_on=false;
			var timerId_kbd=0;
			
			var now_project_order=0;
			
			var title_new="";
			
			var viewer_address='http://ministry.ssch.net/us/room2021.html';
			//var viewer_address='http://ministry.ssch.net/card/notice.html';
			
			if(now_project_type=='묵상')  viewer_address='http://ministry.ssch.net/us/room2021.html';
			if(now_project_type=='주보')  viewer_address='http://ministry.ssch.net/card/notice.html';
			if(now_project_type=='유인물')  viewer_address='../../reveal/index.html';
			
			
			var now_project_num=0;
			
			
			var nowobj={};
			var kill_media="";
			
			var delaytime=2;
			var now_post_ID=0;
			var now_post_title="";
			
			
			var oldVal="";
			var imsiimg="";
			var nowtime=Date.now();
			
			var bg_bright=50;
			
			var byline_intval=1500; 
			
			var check_result="|";
			var bricknumber=1;
			var back_groundimg=[];
			var now_slide_number=1;
			
			function isMobile() {
				return navigator.userAgent.indexOf('Mobi') > -1;
			}
			
			var this_card={},next_Card={};
			var onedit_obj={};
			
			var alldata=$('#alldata').html();
			var project_list={};
			
			var now_unsplash_collection_number="15617643";
			var unsplash_list={};
			
			var unsplash_collection_list=[];
			var unsplash_now_username="lhw2020";
			var last_slide_num=30;
			
			var is_desktop_background=false;
			
			
			var icon_list=["alarm", "alarm-fill", "align-bottom", "align-center", "align-end", "align-middle", "align-start", "align-top", "alt", "app", "app-indicator", "archive", "archive-fill", "arrow-90deg-down", "arrow-90deg-left", "arrow-90deg-right", "arrow-90deg-up", "arrow-bar-down", "arrow-bar-left", "arrow-bar-right", "arrow-bar-up", "arrow-clockwise", "arrow-counterclockwise", "arrow-down", "arrow-down-circle", "arrow-down-circle-fill", "arrow-down-left-circle", "arrow-down-left-circle-fill", "arrow-down-left-square", "arrow-down-left-square-fill", "arrow-down-right-circle", "arrow-down-right-circle-fill", "arrow-down-right-square", "arrow-down-right-square-fill", "arrow-down-square", "arrow-down-square-fill", "arrow-down-left", "arrow-down-right", "arrow-down-short", "arrow-down-up", "arrow-left", "arrow-left-circle", "arrow-left-circle-fill", "arrow-left-square", "arrow-left-square-fill", "arrow-left-right", "arrow-left-short", "arrow-repeat", "arrow-return-left", "arrow-return-right", "arrow-right", "arrow-right-circle", "arrow-right-circle-fill", "arrow-right-square", "arrow-right-square-fill", "arrow-right-short", "arrow-up", "arrow-up-circle", "arrow-up-circle-fill", "arrow-up-left-circle", "arrow-up-left-circle-fill", "arrow-up-left-square", "arrow-up-left-square-fill", "arrow-up-right-circle", "arrow-up-right-circle-fill", "arrow-up-right-square", "arrow-up-right-square-fill", "arrow-up-square", "arrow-up-square-fill", "arrow-up-left", "arrow-up-right", "arrow-up-short", "arrows-angle-contract", "arrows-angle-expand", "arrows-collapse", "arrows-expand", "arrows-fullscreen", "arrows-move", "aspect-ratio", "aspect-ratio-fill", "asterisk", "at", "award", "award-fill", "back", "backspace", "backspace-fill", "backspace-reverse", "backspace-reverse-fill", "badge-3d", "badge-3d-fill", "badge-4k", "badge-4k-fill", "badge-8k", "badge-8k-fill", "badge-ad", "badge-ad-fill", "badge-ar", "badge-ar-fill", "badge-cc", "badge-cc-fill", "badge-hd", "badge-hd-fill", "badge-tm", "badge-tm-fill", "badge-vo", "badge-vo-fill", "badge-vr", "badge-vr-fill", "badge-wc", "badge-wc-fill", "bag", "bag-check", "bag-check-fill", "bag-dash", "bag-dash-fill", "bag-fill", "bag-plus", "bag-plus-fill", "bag-x", "bag-x-fill", "bar-chart", "bar-chart-fill", "bar-chart-line", "bar-chart-line-fill", "bar-chart-steps", "basket", "basket-fill", "basket2", "basket2-fill", "basket3", "basket3-fill", "battery", "battery-charging", "battery-full", "battery-half", "bell", "bell-fill", "bezier", "bezier2", "bicycle", "binoculars", "binoculars-fill", "blockquote-left", "blockquote-right", "book", "book-fill", "book-half", "bookmark", "bookmark-check", "bookmark-check-fill", "bookmark-dash", "bookmark-dash-fill", "bookmark-fill", "bookmark-heart", "bookmark-heart-fill", "bookmark-plus", "bookmark-plus-fill", "bookmark-star", "bookmark-star-fill", "bookmark-x", "bookmark-x-fill", "bookmarks", "bookmarks-fill", "bookshelf", "bootstrap", "bootstrap-fill", "bootstrap-reboot", "border", "border-all", "border-bottom", "border-center", "border-inner", "border-left", "border-middle", "border-outer", "border-right", "border-style", "border-top", "border-width", "bounding-box", "bounding-box-circles", "box", "box-arrow-down-left", "box-arrow-down-right", "box-arrow-down", "box-arrow-in-down", "box-arrow-in-down-left", "box-arrow-in-down-right", "box-arrow-in-left", "box-arrow-in-right", "box-arrow-in-up", "box-arrow-in-up-left", "box-arrow-in-up-right", "box-arrow-left", "box-arrow-right", "box-arrow-up", "box-arrow-up-left", "box-arrow-up-right", "box-seam", "braces", "bricks", "briefcase", "briefcase-fill", "brightness-alt-high", "brightness-alt-high-fill", "brightness-alt-low", "brightness-alt-low-fill", "brightness-high", "brightness-high-fill", "brightness-low", "brightness-low-fill", "broadcast", "broadcast-pin", "brush", "brush-fill", "bucket", "bucket-fill", "bug", "bug-fill", "building", "bullseye", "calculator", "calculator-fill", "calendar", "calendar-check", "calendar-check-fill", "calendar-date", "calendar-date-fill", "calendar-day", "calendar-day-fill", "calendar-event", "calendar-event-fill", "calendar-fill", "calendar-minus", "calendar-minus-fill", "calendar-month", "calendar-month-fill", "calendar-plus", "calendar-plus-fill", "calendar-range", "calendar-range-fill", "calendar-week", "calendar-week-fill", "calendar-x", "calendar-x-fill", "calendar2", "calendar2-check", "calendar2-check-fill", "calendar2-date", "calendar2-date-fill", "calendar2-day", "calendar2-day-fill", "calendar2-event", "calendar2-event-fill", "calendar2-fill", "calendar2-minus", "calendar2-minus-fill", "calendar2-month", "calendar2-month-fill", "calendar2-plus", "calendar2-plus-fill", "calendar2-range", "calendar2-range-fill", "calendar2-week", "calendar2-week-fill", "calendar2-x", "calendar2-x-fill", "calendar3", "calendar3-event", "calendar3-event-fill", "calendar3-fill", "calendar3-range", "calendar3-range-fill", "calendar3-week", "calendar3-week-fill", "calendar4", "calendar4-event", "calendar4-range", "calendar4-week", "camera", "camera2", "camera-fill", "camera-reels", "camera-reels-fill", "camera-video", "camera-video-fill", "camera-video-off", "camera-video-off-fill", "capslock", "capslock-fill", "card-checklist", "card-heading", "card-image", "card-list", "card-text", "caret-down", "caret-down-fill", "caret-down-square", "caret-down-square-fill", "caret-left", "caret-left-fill", "caret-left-square", "caret-left-square-fill", "caret-right", "caret-right-fill", "caret-right-square", "caret-right-square-fill", "caret-up", "caret-up-fill", "caret-up-square", "caret-up-square-fill", "cart", "cart-check", "cart-check-fill", "cart-dash", "cart-dash-fill", "cart-fill", "cart-plus", "cart-plus-fill", "cart-x", "cart-x-fill", "cart2", "cart3", "cart4", "cash", "cash-stack", "cast", "chat", "chat-dots", "chat-dots-fill", "chat-fill", "chat-left", "chat-left-dots", "chat-left-dots-fill", "chat-left-fill", "chat-left-quote", "chat-left-quote-fill", "chat-left-text", "chat-left-text-fill", "chat-quote", "chat-quote-fill", "chat-right", "chat-right-dots", "chat-right-dots-fill", "chat-right-fill", "chat-right-quote", "chat-right-quote-fill", "chat-right-text", "chat-right-text-fill", "chat-square", "chat-square-dots", "chat-square-dots-fill", "chat-square-fill", "chat-square-quote", "chat-square-quote-fill", "chat-square-text", "chat-square-text-fill", "chat-text", "chat-text-fill", "check", "check-all", "check-circle", "check-circle-fill", "check-square", "check-square-fill", "check2", "check2-all", "check2-circle", "check2-square", "chevron-bar-contract", "chevron-bar-down", "chevron-bar-expand", "chevron-bar-left", "chevron-bar-right", "chevron-bar-up", "chevron-compact-down", "chevron-compact-left", "chevron-compact-right", "chevron-compact-up", "chevron-contract", "chevron-double-down", "chevron-double-left", "chevron-double-right", "chevron-double-up", "chevron-down", "chevron-expand", "chevron-left", "chevron-right", "chevron-up", "circle", "circle-fill", "circle-half", "slash-circle", "circle-square", "clipboard", "clipboard-check", "clipboard-data", "clipboard-minus", "clipboard-plus", "clipboard-x", "clock", "clock-fill", "clock-history", "cloud", "cloud-arrow-down", "cloud-arrow-down-fill", "cloud-arrow-up", "cloud-arrow-up-fill", "cloud-check", "cloud-check-fill", "cloud-download", "cloud-download-fill", "cloud-drizzle", "cloud-drizzle-fill", "cloud-fill", "cloud-fog", "cloud-fog-fill", "cloud-fog2", "cloud-fog2-fill", "cloud-hail", "cloud-hail-fill", "cloud-haze", "cloud-haze-1", "cloud-haze-fill", "cloud-haze2-fill", "cloud-lightning", "cloud-lightning-fill", "cloud-lightning-rain", "cloud-lightning-rain-fill", "cloud-minus", "cloud-minus-fill", "cloud-moon", "cloud-moon-fill", "cloud-plus", "cloud-plus-fill", "cloud-rain", "cloud-rain-fill", "cloud-rain-heavy", "cloud-rain-heavy-fill", "cloud-slash", "cloud-slash-fill", "cloud-sleet", "cloud-sleet-fill", "cloud-snow", "cloud-snow-fill", "cloud-sun", "cloud-sun-fill", "cloud-upload", "cloud-upload-fill", "clouds", "clouds-fill", "cloudy", "cloudy-fill", "code", "code-slash", "code-square", "collection", "collection-fill", "collection-play", "collection-play-fill", "columns", "columns-gap", "command", "compass", "compass-fill", "cone", "cone-striped", "controller", "cpu", "cpu-fill", "credit-card", "credit-card-2-back", "credit-card-2-back-fill", "credit-card-2-front", "credit-card-2-front-fill", "credit-card-fill", "crop", "cup", "cup-fill", "cup-straw", "cursor", "cursor-fill", "cursor-text", "dash", "dash-circle", "dash-circle-dotted", "dash-circle-fill", "dash-square", "dash-square-dotted", "dash-square-fill", "diagram-2", "diagram-2-fill", "diagram-3", "diagram-3-fill", "diamond", "diamond-fill", "diamond-half", "dice-1", "dice-1-fill", "dice-2", "dice-2-fill", "dice-3", "dice-3-fill", "dice-4", "dice-4-fill", "dice-5", "dice-5-fill", "dice-6", "dice-6-fill", "disc", "disc-fill", "discord", "display", "display-fill", "distribute-horizontal", "distribute-vertical", "door-closed", "door-closed-fill", "door-open", "door-open-fill", "dot", "download", "droplet", "droplet-fill", "droplet-half", "earbuds", "easel", "easel-fill", "egg", "egg-fill", "egg-fried", "eject", "eject-fill", "emoji-angry", "emoji-angry-fill", "emoji-dizzy", "emoji-dizzy-fill", "emoji-expressionless", "emoji-expressionless-fill", "emoji-frown", "emoji-frown-fill", "emoji-heart-eyes", "emoji-heart-eyes-fill", "emoji-laughing", "emoji-laughing-fill", "emoji-neutral", "emoji-neutral-fill", "emoji-smile", "emoji-smile-fill", "emoji-smile-upside-down", "emoji-smile-upside-down-fill", "emoji-sunglasses", "emoji-sunglasses-fill", "emoji-wink", "emoji-wink-fill", "envelope", "envelope-fill", "envelope-open", "envelope-open-fill", "eraser", "eraser-fill", "exclamation", "exclamation-circle", "exclamation-circle-fill", "exclamation-diamond", "exclamation-diamond-fill", "exclamation-octagon", "exclamation-octagon-fill", "exclamation-square", "exclamation-square-fill", "exclamation-triangle", "exclamation-triangle-fill", "exclude", "eye", "eye-fill", "eye-slash", "eye-slash-fill", "eyedropper", "eyeglasses", "facebook", "file", "file-arrow-down", "file-arrow-down-fill", "file-arrow-up", "file-arrow-up-fill", "file-bar-graph", "file-bar-graph-fill", "file-binary", "file-binary-fill", "file-break", "file-break-fill", "file-check", "file-check-fill", "file-code", "file-code-fill", "file-diff", "file-diff-fill", "file-earmark", "file-earmark-arrow-down", "file-earmark-arrow-down-fill", "file-earmark-arrow-up", "file-earmark-arrow-up-fill", "file-earmark-bar-graph", "file-earmark-bar-graph-fill", "file-earmark-binary", "file-earmark-binary-fill", "file-earmark-break", "file-earmark-break-fill", "file-earmark-check", "file-earmark-check-fill", "file-earmark-code", "file-earmark-code-fill", "file-earmark-diff", "file-earmark-diff-fill", "file-earmark-easel", "file-earmark-easel-fill", "file-earmark-excel", "file-earmark-excel-fill", "file-earmark-fill", "file-earmark-font", "file-earmark-font-fill", "file-earmark-image", "file-earmark-image-fill", "file-earmark-lock", "file-earmark-lock-fill", "file-earmark-lock2", "file-earmark-lock2-fill", "file-earmark-medical", "file-earmark-medical-fill", "file-earmark-minus", "file-earmark-minus-fill", "file-earmark-music", "file-earmark-music-fill", "file-earmark-person", "file-earmark-person-fill", "file-earmark-play", "file-earmark-play-fill", "file-earmark-plus", "file-earmark-plus-fill", "file-earmark-post", "file-earmark-post-fill", "file-earmark-ppt", "file-earmark-ppt-fill", "file-earmark-richtext", "file-earmark-richtext-fill", "file-earmark-ruled", "file-earmark-ruled-fill", "file-earmark-slides", "file-earmark-slides-fill", "file-earmark-spreadsheet", "file-earmark-spreadsheet-fill", "file-earmark-text", "file-earmark-text-fill", "file-earmark-word", "file-earmark-word-fill", "file-earmark-x", "file-earmark-x-fill", "file-earmark-zip", "file-earmark-zip-fill", "file-easel", "file-easel-fill", "file-excel", "file-excel-fill", "file-fill", "file-font", "file-font-fill", "file-image", "file-image-fill", "file-lock", "file-lock-fill", "file-lock2", "file-lock2-fill", "file-medical", "file-medical-fill", "file-minus", "file-minus-fill", "file-music", "file-music-fill", "file-person", "file-person-fill", "file-play", "file-play-fill", "file-plus", "file-plus-fill", "file-post", "file-post-fill", "file-ppt", "file-ppt-fill", "file-richtext", "file-richtext-fill", "file-ruled", "file-ruled-fill", "file-slides", "file-slides-fill", "file-spreadsheet", "file-spreadsheet-fill", "file-text", "file-text-fill", "file-word", "file-word-fill", "file-x", "file-x-fill", "file-zip", "file-zip-fill", "files", "files-alt", "film", "filter", "filter-circle", "filter-circle-fill", "filter-left", "filter-right", "filter-square", "filter-square-fill", "flag", "flag-fill", "flower1", "flower2", "flower3", "folder", "folder-check", "folder-fill", "folder-minus", "folder-plus", "folder-symlink", "folder-symlink-fill", "folder-x", "folder2", "folder2-open", "fonts", "forward", "forward-fill", "front", "fullscreen", "fullscreen-exit", "funnel", "funnel-fill", "gear", "gear-fill", "gear-wide", "gear-wide-connected", "gem", "geo", "geo-alt", "geo-alt-fill", "geo-fill", "gift", "gift-fill", "github", "globe", "globe2", "google", "graph-down", "graph-up", "grid", "grid-1x2", "grid-1x2-fill", "grid-3x2", "grid-3x2-gap", "grid-3x2-gap-fill", "grid-3x3", "grid-3x3-gap", "grid-3x3-gap-fill", "grid-fill", "grip-horizontal", "grip-vertical", "hammer", "hand-index", "hand-index-fill", "hand-index-thumb", "hand-index-thumb-fill", "hand-thumbs-down", "hand-thumbs-down-fill", "hand-thumbs-up", "hand-thumbs-up-fill", "handbag", "handbag-fill", "hash", "hdd", "hdd-fill", "hdd-network", "hdd-network-fill", "hdd-rack", "hdd-rack-fill", "hdd-stack", "hdd-stack-fill", "headphones", "headset", "heart", "heart-fill", "heart-half", "heptagon", "heptagon-fill", "heptagon-half", "hexagon", "hexagon-fill", "hexagon-half", "hourglass", "hourglass-bottom", "hourglass-split", "hourglass-top", "house", "house-door", "house-door-fill", "house-fill", "hr", "hurricane", "image", "image-alt", "image-fill", "images", "inbox", "inbox-fill", "inboxes-fill", "inboxes", "info", "info-circle", "info-circle-fill", "info-square", "info-square-fill", "input-cursor", "input-cursor-text", "instagram", "intersect", "journal", "journal-album", "journal-arrow-down", "journal-arrow-up", "journal-bookmark", "journal-bookmark-fill", "journal-check", "journal-code", "journal-medical", "journal-minus", "journal-plus", "journal-richtext", "journal-text", "journal-x", "journals", "joystick", "justify", "justify-left", "justify-right", "kanban", "kanban-fill", "key", "key-fill", "keyboard", "keyboard-fill", "ladder", "lamp", "lamp-fill", "laptop", "laptop-fill", "layer-backward", "layer-forward", "layers", "layers-fill", "layers-half", "layout-sidebar", "layout-sidebar-inset-reverse", "layout-sidebar-inset", "layout-sidebar-reverse", "layout-split", "layout-text-sidebar", "layout-text-sidebar-reverse", "layout-text-window", "layout-text-window-reverse", "layout-three-columns", "layout-wtf", "life-preserver", "lightbulb", "lightbulb-fill", "lightbulb-off", "lightbulb-off-fill", "lightning", "lightning-charge", "lightning-charge-fill", "lightning-fill", "link", "link-45deg", "linkedin", "list", "list-check", "list-nested", "list-ol", "list-stars", "list-task", "list-ul", "lock", "lock-fill", "mailbox", "mailbox2", "map", "map-fill", "markdown", "markdown-fill", "mask", "megaphone", "megaphone-fill", "menu-app", "menu-app-fill", "menu-button", "menu-button-fill", "menu-button-wide", "menu-button-wide-fill", "menu-down", "menu-up", "mic", "mic-fill", "mic-mute", "mic-mute-fill", "minecart", "minecart-loaded", "moisture", "moon", "moon-fill", "moon-stars", "moon-stars-fill", "mouse", "mouse-fill", "mouse2", "mouse2-fill", "mouse3", "mouse3-fill", "music-note", "music-note-beamed", "music-note-list", "music-player", "music-player-fill", "newspaper", "node-minus", "node-minus-fill", "node-plus", "node-plus-fill", "nut", "nut-fill", "octagon", "octagon-fill", "octagon-half", "option", "outlet", "paint-bucket", "palette", "palette-fill", "palette2", "paperclip", "paragraph", "patch-check", "patch-check-fill", "patch-exclamation", "patch-exclamation-fill", "patch-minus", "patch-minus-fill", "patch-plus", "patch-plus-fill", "patch-question", "patch-question-fill", "pause", "pause-btn", "pause-btn-fill", "pause-circle", "pause-circle-fill", "pause-fill", "peace", "peace-fill", "pen", "pen-fill", "pencil", "pencil-fill", "pencil-square", "pentagon", "pentagon-fill", "pentagon-half", "people", "person-circle", "people-fill", "percent", "person", "person-badge", "person-badge-fill", "person-bounding-box", "person-check", "person-check-fill", "person-dash", "person-dash-fill", "person-fill", "person-lines-fill", "person-plus", "person-plus-fill", "person-square", "person-x", "person-x-fill", "phone", "phone-fill", "phone-landscape", "phone-landscape-fill", "phone-vibrate", "phone-vibrate-fill", "pie-chart", "pie-chart-fill", "pin", "pin-angle", "pin-angle-fill", "pin-fill", "pip", "pip-fill", "play", "play-btn", "play-btn-fill", "play-circle", "play-circle-fill", "play-fill", "plug", "plug-fill", "plus", "plus-circle", "plus-circle-dotted", "plus-circle-fill", "plus-square", "plus-square-dotted", "plus-square-fill", "power", "printer", "printer-fill", "puzzle", "puzzle-fill", "question", "question-circle", "question-diamond", "question-diamond-fill", "question-circle-fill", "question-octagon", "question-octagon-fill", "question-square", "question-square-fill", "rainbow", "receipt", "receipt-cutoff", "reception-0", "reception-1", "reception-2", "reception-3", "reception-4", "record", "record-btn", "record-btn-fill", "record-circle", "record-circle-fill", "record-fill", "record2", "record2-fill", "reply", "reply-all", "reply-all-fill", "reply-fill", "rss", "rss-fill", "rulers", "save", "save-fill", "save2", "save2-fill", "scissors", "screwdriver", "search", "segmented-nav", "server", "share", "share-fill", "shield", "shield-check", "shield-exclamation", "shield-fill", "shield-fill-check", "shield-fill-exclamation", "shield-fill-minus", "shield-fill-plus", "shield-fill-x", "shield-lock", "shield-lock-fill", "shield-minus", "shield-plus", "shield-shaded", "shield-slash", "shield-slash-fill", "shield-x", "shift", "shift-fill", "shop", "shop-window", "shuffle", "signpost", "signpost-2", "signpost-2-fill", "signpost-fill", "signpost-split", "signpost-split-fill", "sim", "sim-fill", "skip-backward", "skip-backward-btn", "skip-backward-btn-fill", "skip-backward-circle", "skip-backward-circle-fill", "skip-backward-fill", "skip-end", "skip-end-btn", "skip-end-btn-fill", "skip-end-circle", "skip-end-circle-fill", "skip-end-fill", "skip-forward", "skip-forward-btn", "skip-forward-btn-fill", "skip-forward-circle", "skip-forward-circle-fill", "skip-forward-fill", "skip-start", "skip-start-btn", "skip-start-btn-fill", "skip-start-circle", "skip-start-circle-fill", "skip-start-fill", "slack", "slash", "slash-circle-fill", "slash-square", "slash-square-fill", "sliders", "smartwatch", "snow", "snow2", "snow3", "sort-alpha-down", "sort-alpha-down-alt", "sort-alpha-up", "sort-alpha-up-alt", "sort-down", "sort-down-alt", "sort-numeric-down", "sort-numeric-down-alt", "sort-numeric-up", "sort-numeric-up-alt", "sort-up", "sort-up-alt", "soundwave", "speaker", "speaker-fill", "speedometer", "speedometer2", "spellcheck", "square", "square-fill", "square-half", "stack", "star", "star-fill", "star-half", "stars", "stickies", "stickies-fill", "sticky", "sticky-fill", "stop", "stop-btn", "stop-btn-fill", "stop-circle", "stop-circle-fill", "stop-fill", "stoplights", "stoplights-fill", "stopwatch", "stopwatch-fill", "subtract", "suit-club", "suit-club-fill", "suit-diamond", "suit-diamond-fill", "suit-heart", "suit-heart-fill", "suit-spade", "suit-spade-fill", "sun", "sun-fill", "sunglasses", "sunrise", "sunrise-fill", "sunset", "sunset-fill", "symmetry-horizontal", "symmetry-vertical", "table", "tablet", "tablet-fill", "tablet-landscape", "tablet-landscape-fill", "tag", "tag-fill", "tags", "tags-fill", "telegram", "telephone", "telephone-fill", "telephone-forward", "telephone-forward-fill", "telephone-inbound", "telephone-inbound-fill", "telephone-minus", "telephone-minus-fill", "telephone-outbound", "telephone-outbound-fill", "telephone-plus", "telephone-plus-fill", "telephone-x", "telephone-x-fill", "terminal", "terminal-fill", "text-center", "text-indent-left", "text-indent-right", "text-left", "text-paragraph", "text-right", "textarea", "textarea-resize", "textarea-t", "thermometer", "thermometer-half", "thermometer-high", "thermometer-low", "thermometer-snow", "thermometer-sun", "three-dots", "three-dots-vertical", "toggle-off", "toggle-on", "toggle2-off", "toggle2-on", "toggles", "toggles2", "tools", "tornado", "trash", "trash-fill", "trash2", "trash2-fill", "tree", "tree-fill", "triangle", "triangle-fill", "triangle-half", "trophy", "trophy-fill", "tropical-storm", "truck", "truck-flatbed", "tsunami", "tv", "tv-fill", "twitch", "twitter", "type", "type-bold", "type-h1", "type-h2", "type-h3", "type-italic", "type-strikethrough", "type-underline", "ui-checks", "ui-checks-grid", "ui-radios", "ui-radios-grid", "umbrella", "umbrella-fill", "union", "unlock", "unlock-fill", "upc", "upc-scan", "upload", "vector-pen", "view-list", "view-stacked", "vinyl", "vinyl-fill", "voicemail", "volume-down", "volume-down-fill", "volume-mute", "volume-mute-fill", "volume-off", "volume-off-fill", "volume-up", "volume-up-fill", "vr", "wallet", "wallet-fill", "wallet2", "watch", "water", "whatsapp", "wifi", "wifi-1", "wifi-2", "wifi-off", "wind", "window", "window-dock", "window-sidebar", "wrench", "x", "x-circle", "x-circle-fill", "x-diamond", "x-diamond-fill", "x-octagon", "x-octagon-fill", "x-square", "x-square-fill", "youtube", "zoom-in", "zoom-out"];
			
			
			
			var isCtrl, isAlt; // ctrl. Alt 눌림 여부 확인
			document.onkeyup = function(e) {
				if (e.which == 17) { isCtrl = false; toggle_kbd_hide('ctrl');}
				if (e.which == 18) { isAlt = false; toggle_kbd_hide('alt'); }
				
				if(e.keyCode >= 37 ||e.keyCode<=40) menu_icon_check(get_now_tag()); //console.log(get_now_tag());
				
				toggle_kbd_hide();
				
			}
			
			//	document.onkeydown = function(e) {
			
			document.onkeydown = function(e) {
				
				console.log(e.which);
				
				
				if (e.which == 17) { isCtrl = true; toggle_kbd_show('ctrl');}
				if (e.which == 18) { isAlt = true; toggle_kbd_show('alt'); }
				
				
				//	console.log(e.which , isCtrl, isAlt)
				
				if (e.which == 190 && isCtrl == true) { // Ctrl + >  단락전환시작
					e.preventDefault();
					if( $('.word_change').length>0) {
						$('#btn_change_div').click();
						alertify.success('단락이 전환되었습니다.');
					}
					
				}
				
				
				if (e.which == 73 && isAlt) { // alt + i   아이콘
					e.preventDefault();
					$('.tog_edit_icon').toggle(); 
					
				}
				
				
				
				if (e.which == 83 && isCtrl == true) { // Ctrl +s 저장하기
					e.preventDefault();
					var imsi_slide=alldata.split("슬라이드::");
					
					imsi_slide[now_slide_number]=$('#editor').val();
					
					alldata=imsi_slide.join("슬라이드::")
					
					$('.onslide').eq(now_slide_number-1).addClass('list-group-item-danger');
					//console.log(now_slide_number);
					
					
					if(now_post_ID==0) alert("아직 불러온 슬라이드가 없습니다");
					save_to_db();
					$('#btn_view').click();	
					
					return false;
				}
				
				if (e.which == 79 && isCtrl == true) { // Ctrl +o
					e.preventDefault();
					$('#div_projects').toggle();
					load_project_list();
					
				}
				if (e.which == 81 && isCtrl == true) { // Ctrl +Q QR 코드 
					e.preventDefault();
					$('#btn_make_qr').click();
					alertify.success("현재 슬라이드 QR 코드");
				}
				
				if (e.which == 82 && isCtrl == true) { // Ctrl +R 다시 읽기
					e.preventDefault();
					$('#btn_load_db').click();
					alertify.success("다시 불러왔습니다.");	
				}
				
				if (e.which == 66 && isCtrl == true) { // Ctrl +B  배경선택
					e.preventDefault();
					$('#btn_modal_pic').click();
				}
				
				if (e.which == 78 && isAlt  ) { // Alt + N   새창으로 보기
					e.preventDefault();
					alertify.success("새창에서 보기");	
					//	$('#btn_view_new_window').click();
					window.open($('#btn_view_new_window').prop('href'));
					
				}
				
				if (isAlt &&  e.keyCode == 38 ) { // Alt + 방향키 상
					
					prev_project();
					alertify.success("이전 프로젝트로 이동합니다.");	
					
					return;
					
				}
				if (isAlt &&  e.keyCode == 40 ) { // Alt + 방향키 하
					
					next_project();
					alertify.success("다음 프로젝트로 이동합니다.");	
					
					return;
					
				}
				
				
				if (isCtrl == true && e.keyCode == 38 ) { // Ctrl + 방향키 상
					
					
					if(now_slide_number>1) {
						alertify.success("슬라이드 "+(now_slide_number-1) +"로 이동합니다.");	
						$('.onslide').eq(now_slide_number-2).click();
						} else {
						alertify.success("첫번째 슬라이드입니다.");	
					}
					return;
					
				}
				if (isCtrl == true && e.keyCode == 40 ) { // Ctrl + 방향키 하
					
					
					if(now_slide_number<last_slide_num) {
						alertify.success("슬라이드 "+(now_slide_number+1) +"로 이동합니다.");	
						$('.onslide').eq(now_slide_number).click();
						} else {
						alertify.success("마지막 슬라이드입니다.");	
					}
					return;
					
				}
				
				
				if (isCtrl == true && e.keyCode == 187 ) { // Ctrl + =
					e.preventDefault();
					change_size_Tag();
					
				}
				if (isCtrl == true && e.keyCode == 189 ) { // Ctrl + -
					e.preventDefault();
					change_align();
					
					
				}
				if (e.keyCode == 27 ) { // Ctrl + -
					isCtrl = false;
					isAlt=false;
					toggle_kbd_hide('ctrl');
					
				}
				
			}
			
			
			$('.btn_ratio').click(function () {
				$('#main_fr').height($('#main_fr').width()*$(this).data('ratio'));
				
			});
			
			
			$('#btn_modal_pic').click(function () {
				
				
				//$('#modal_background_pic').modal();
				
				$('.tog_edit').toggle();
				//$('#div_pan1, #div_pan3').toggleClass('d-none');
				//	$('#div_pan2').toggleClass('col-md-4').toggleClass('col-md-9');
				setSildeTitle();
				
				
			});



			$(document).on("click",".selbg",function(event) {
				//$('.selbg').click(function () {
				
				
				var nowhtml=$('#editor').val();
				
				var nowhtml_pic="";
				var new_pic=$(this).prop('src').replace("thumbnail_small/","");
				
				var pic_type="regular size";
				var basic_bg="배경사진::";
				
				if(isCtrl) basic_bg="컴퓨터배경::";
				
				
				if($(this).hasClass("unsplash_img")) {
					//	console.log($(this).data('unspl_num'));
					new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.regular;
					//new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.small
					//if(new_pic==undefined) new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.regular;
					if(new_pic==undefined) 	{
						new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.small;
						
						pic_type='small size';
						
					}
					alertify.success(pic_type);
				}
				
				
				
				//console.log(new_pic);
				
				if(nowhtml.split(basic_bg).length>1) {
					
					nowhtml_pic=nowhtml.split(basic_bg)[1].split("\n")[0];
					nowhtml=nowhtml.replace(basic_bg+nowhtml_pic,basic_bg+new_pic);
					
					$('#editor').val(nowhtml);
					} else {
					
					nowhtml="\n"+basic_bg+new_pic+"\n"+nowhtml;
					$('#editor').val(nowhtml);
					
				}
				
				
				
				chage_background_img(new_pic);
				
			});
			
			/*
				$(document).on("click",".selbg",function(event) {   // 컴퓨터 배경
				//$('.selbg').click(function () {
				
				
				var nowhtml=$('#editor').val();
				
				var nowhtml_pic="";
				var new_pic=$(this).prop('src').replace("thumbnail_small/","");
				
				var pic_type="regular size";
				
				if($(this).hasClass("unsplash_img")) {
				//	console.log($(this).data('unspl_num'));
				new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.regular;
				//new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.small
				//if(new_pic==undefined) new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.regular;
				if(new_pic==undefined) 	{
				new_pic=unsplash_list[$(this).data('unspl_num')-0].urls.small;
				
				pic_type='small size';
				
				}
				alertify.success(pic_type);
				}
				
				
				
				//console.log(new_pic);
				
				if(nowhtml.split("배경사진::").length>1) {
				
				nowhtml_pic=nowhtml.split("배경사진::")[1].split("\n")[0];
				nowhtml=nowhtml.replace("배경사진::"+nowhtml_pic,"배경사진::"+new_pic);
				
				$('#editor').val(nowhtml);
				} else {
				
				nowhtml="\n"+"배경사진::"+new_pic+"\n"+nowhtml;
				$('#editor').val(nowhtml);
				
				}
				
				
				
				chage_background_img(new_pic);
				
				});
			*/
			
			//selbg
			
			//btn_new_unsplsh_user
			
			$('#btn_new_unsplsh_user').click(function() {
				
				var imsi_unsplash_user = prompt('unsplash 사용자 이름을 알려주세요', unsplash_now_username);
				if(imsi_unsplash_user==undefined||imsi_unsplash_user==0||imsi_unsplash_user=="") return;
				
				unsplash_now_username=imsi_unsplash_user.trim();
				
				load_users_collection_list(unsplash_now_username);
				
				
				//========================
				
			});
			
			
			$('#btn_new_unsplsh').click(function() {
				now_unsplash_collection_number = prompt('unsplash 컬렉션 번호를 입력하세요', "15617643");
				now_unsplash_collection_number=now_unsplash_collection_number.trim();
				
				load_unsplash_collection("");
				
			});
			
			
			
			
			function load_users_collection_list(unsplash_user_name) {
				var imsi_username=unsplash_user_name;
				
				
				if(unsplash_user_name==""||unsplash_user_name==undefined)   imsi_username=unsplash_now_username;
				
				$.ajax({   
					url: "https://api.unsplash.com/users/"+imsi_username+"/collections?client_id=rrNQsTNea8j7ckUoQ3_8sjvRzXugMqcZFtfmCyITcd0",
					dataType: 'json',
					type:"GET",
					success: function(data) {
						unsplash_collection_list=data;
						//div_collection_list
						var imsi_coll_html="";
						
						unsplash_collection_list.forEach(x=> {
							imsi_coll_html+="<a class='btn btn-outline-warning btn-xs btn-sel-coll m-1' onclick='void(0);' data-colnum='"+x.id+"'>"+x.title+"("+x.total_photos+"건)</a>";
							
						});
						
						if(unsplash_collection_list.length>0) {
							save_to_db_unsplash();
							
							
							$('#div_collection_list').html(imsi_coll_html);
							} else {
							alertify.error("해당 사용자의 자료가 없습니다.");
							
						}
					}});
					
			}
			
			
			// With JQuery
			/*$('#ex1').slider({
				formatter: function(value) {
				return 'Current value: ' + value;
				}
			});*/
			
			
			$(document).on('click','.btn-sel-coll', function (event) {
				
				
				//$('.btn-sel-coll').removeClass('btn-warning');
				//$(this).addClass('btn-warning');
				
				load_unsplash_collection($(this).data('colnum'));
				
			});
			
			$(document).on('mouseover','.incard', function (event) {
				
				//console.log($(this).text());
				
			});
			
			
			//incard h4
			
			
			function load_unsplash_collection(collection_id) {
				//now_unsplash_collection_number
				//now_unsplash_collection_number
				if(collection_id=="") collection_id=now_unsplash_collection_number;
				
				
				$.ajax({  //925697
					//url: "https://api.unsplash.com/collections/15617643/photos?client_id=rrNQsTNea8j7ckUoQ3_8sjvRzXugMqcZFtfmCyITcd0",
					url: "https://api.unsplash.com/collections/"+collection_id+"/photos?client_id=rrNQsTNea8j7ckUoQ3_8sjvRzXugMqcZFtfmCyITcd0&per_page=100",
					dataType: 'json',
					type:"GET",
					success: function(data) {
						var imsi_unsplash_list="";
						var imsi_cnt=0;
						//console.log(data);
						
						unsplash_list=data;
						
						//unsplash_list[0].urls.thumb
						
						unsplash_list.forEach(x=>{
							imsi_unsplash_list+="<div class='col-4'><img src='"+x.urls.thumb+"' class=' img-thumbnail rounded selbg  unsplash_img' onclick='void(0);' data-unspl_num='"+(imsi_cnt++)+"' /></div>";
							
							//div_unsplash
							
							
							
							
						});
						
						$('#div_unsplash').html(imsi_unsplash_list);
						
					}
					
					
					
					
				});
				
			}
			
			
			$(document).ready(function(){
			
		
			
				//load_unsplash();
				make_btn_unsplash_userlist();
				
				$('.ctrlk').parent().find('i').addClass('icont');
				$('.altk').parent().find('i').addClass('icont');
				$(function () {
					$('[data-toggle="tooltip"]').tooltip()
				})
				alertify.set('notifier','delay', 1.5);
				
				alertify.defaults.transition = "slide";
				alertify.defaults.theme.ok = "btn btn-primary";
				alertify.defaults.theme.cancel = "btn btn-danger";
				alertify.defaults.theme.input = "form-control";
				
				
				setSildeTitle();
				$('#div_projects').hide();
				
				load_project_list();
				setTimeout("now_post_ID=project_list[project_list.length-1].ID;",1000);
				
				setTimeout("load_first_db();",1200);
				
				
				
				load_users_collection_list();
				show_icon();
				
				$( function() {
					$( "#sortable" ).sortable({
						
						stop: function( event, ui ) {
							
							//console.log($(ui.item[0]).data('sd'));
							
							var imsi_slides=[];
							$('.onslide').each(function (index, item) {
								if(index>=alldata.split("슬라이드::").length) return;
								
								imsi_slides.push(alldata.split("슬라이드::")[$(item).data('sd')]);
								//$(item).data('sd',index+1);
								//console.log($(item).data('sd'));
								
								
							});	
							for(i=0;i<$('.onslide').length;i++) $('.onslide').eq(i).data('sd',i+1);
							
							
							//	console.log(imsi_slides);
							imsi_slides.pop(); 
							alldata="슬라이드::"+imsi_slides.join("슬라이드::");
							$(ui.item[0]).click();
							setSildeTitle();
							
							
							
							
						}
					});
					$( "#sortable" ).disableSelection();
				} );
				
				$('.maincard').eq(0).show();
				
			});
			
			
			
			function chage_background_img(img_name) {
				$('#main_fr').css('background-image',"url('"+img_name+"'");
				
				
				//console.log(img_name);
				
			}
			
			
			
			$('#btn_view').click(function() {
				
				var nowtext=$('#editor').val().split("아래는메모사항::")[0];
				var nowhtml=nowtext;
				var nowhtml_pic="";
				var nowhtml_pic_desktop="";
				var imsitag="";
				
				$('.maincard').eq(0).html("");
				$('svg').detach();
				alltag_data=[];
				
				console.log('ffff');
				
				
				if(now_project_type=='유인물') {
					//$('#main_if').prop('src',"");
					
					$('#main_if').attr('src',viewer_address+"?making&n="+now_post_ID+"/#/"+(now_slide_number-1));
					//document.getElementById('main_if').contentDocument.location.reload(true);
					$('#main_if').height($('#main_if').width()*0.7);
				}
				
				
				nowhtml=nowtext.replaceAll("슬라이드::\n","").replaceAll("===","<hr/>").replaceAll("---","<hr class='sm'>").replaceAll("{{","<span class='text-muted'>").replaceAll("}}","</span>");
				//nowhtml=nowhtml.replaceAll("<script"+">","<!"+"--").replaceAll("</scr"+"ipt>","--"+">");
				
				//chage_background_img(" ");
				$('#main_fr').css('background-image',"url('')");
				
				if(nowhtml.includes('배경색::')) {
					var bgcolor=nowhtml.split("배경색::")[1].split("\n")[0];
					$('#main_fr').css('background-color',bgcolor);
					
					
					nowhtml=nowhtml.replace("배경색::"+bgcolor,"");
					
				}
				
				
				if(is_desktop_background)  {  //컴퓨터 배경으로 볼때는 기본 배경부분을 지운다.
					
					nowhtml_pic=nowhtml.split("배경사진::")[1].split("\n")[0];
					nowhtml=nowhtml.replace("배경사진::"+nowhtml_pic,"");
					
					
					
					nowhtml_pic=nowhtml.split("컴퓨터배경::")[1].split("\n")[0];
					nowhtml=nowhtml.replace("컴퓨터배경::"+nowhtml_pic_desktop,"");
					
					if(nowhtml_pic_desktop=="") nowhtml_pic_desktop=nowhtml_pic;
					chage_background_img(nowhtml_pic_desktop);
					
					} else {
					
					if(nowhtml.split("배경사진::").length>1) {
						//	nowhtml_pic=;
						
						
						
						nowhtml_pic=nowhtml.split("배경사진::")[1].split("\n")[0];
						nowhtml=nowhtml.replace("배경사진::"+nowhtml_pic,"");
						chage_background_img(nowhtml_pic);
						
					}
				}
				
				if(nowhtml.split("컴퓨터배경::").length>1) {
					nowhtml=nowhtml.replace("컴퓨터배경::"+nowhtml.split("컴퓨터배경::")[1].split("\n")[0],"");
				}
				
				if(nowhtml.indexOf("공유제목::")>0) {
					
					var imsiSrc=nowhtml.split("공유제목::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("공유제목::"+imsiSrc,"");
					
				}
				if(nowhtml.indexOf("공유설명::")>0) {
					
					var imsiSrc=nowhtml.split("공유설명::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("공유설명::"+imsiSrc,"");
					
				}
				if(nowhtml.indexOf("공유썸네일::")>0) {
					
					var imsiSrc=nowhtml.split("공유썸네일::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("공유썸네일::"+imsiSrc,"");
					
				}
				if(nowhtml.indexOf("다마친후이동할페이지::")>0) {
					
					var imsiSrc=nowhtml.split("다마친후이동할페이지::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("다마친후이동할페이지::"+imsiSrc,"");
					
				}
				
				
				
				
				
				nowhtml= tagconvert(nowhtml, "<h2 class='text-center incard h2center'>","</h2>","가운데제목::");
				nowhtml= tagconvert(nowhtml, "<h2 class='text-right incard h2right'>","</h2>","오른쪽제목::");
				nowhtml= tagconvert(nowhtml, "<h2 class='incard h2'>","</h2>","제목::");
				
				
				
				if(nowhtml.includes('alltag_data')) {
					//alltag_data
					//for(i=0;i<=100;i++)			 {
					nowhtml=nowhtml.replaceAll("<!-"+"-"+"alltag_data","<script>alltag_data");
					nowhtml=nowhtml.replaceAll("[end]---"+">","\n</scr"+"ipt>");
					
					
					// }
					
					} else {
					nowhtml=nowhtml.replaceAll("[[","<sub>");
					nowhtml=nowhtml.replaceAll("]]","</sub>");
					
					nowhtml=nowhtml.replaceAll("[","<b class='colyel'>");
					nowhtml=nowhtml.replaceAll("]","</b>");
					
				}
				
				nowhtml=nowhtml.replaceAll("줄바꿈::","<br/>");
				
				
				
				nowhtml=nowhtml.replaceAll("단락시작과전환되는초::","<div class='word_change'>");
				nowhtml=nowhtml.replaceAll("단락시작::","<div class='word_change'>");
				nowhtml=nowhtml.replaceAll("단락끝::","</div>");
				nowhtml=nowhtml.replaceAll("단락전환시작::","</div>");
				nowhtml=nowhtml.replaceAll("\n상자시작::", "\n<div class='card bg-light ml-2 mr-0 ' ><div class='card-body p-1 pl-2'>");
				nowhtml=nowhtml.replaceAll("\n상자끝::", "\n</div></div>");
				
				
				nowhtml= tagconvert(nowhtml, "<li class='incard li'>","</li>","설명*::");
				
				nowhtml=tagconvert(nowhtml,"<button  class='btn btn-warning btn_next float-right' >","</button>","다음버튼::");
				
				nowhtml=tagconvert(nowhtml,"<a  class='btn btn-warning  btn-block'  id='btn_end' >","</a>","마지막버튼::");
				
				
				nowhtml= tagconvert(nowhtml, "\n<h6 class='h6small  incard  mt-2 ml-3'>","</h6>","\n#####");	
				
				
				nowhtml= tagconvert(nowhtml, "\n<h6 class='h6  incard text-muted  mt-2 ml-3'>","</h6>","\n####");					
				nowhtml= tagconvert(nowhtml, "\n<h5 class='h5 incard mt-3'>","</h5>","\n###");
				
				nowhtml= tagconvert(nowhtml, "\n<h4 class='h4 incard  mt-2'>","</h4>","\n##");
				
				nowhtml= tagconvert(nowhtml, "\n<h2 class='h2 incard  mt-2'>","</h2>","\n#");
				
				nowhtml=tagconvert(nowhtml,"<a class='btn btn-outline-info btn-sm float-right linkbtn ml-1 p-0 pl-3 pr-3' href='' target='_blank'>","</a>","링크버튼::"); 
				
				
				
				
				
				nowhtml=tagconvert(nowhtml,"<table class='table table-sm  table-striped'><thead class='thead-dark in_table_head'><th>","</th></thead><tbody>","표시작::");
				
				nowhtml=tagconvert(nowhtml,"\n<tr class='in_table_body'><td>","</td></tr>","표본문::");
				
				nowhtml=nowhtml.replaceAll("표끝::\n","\n</tbody>\n</table>\n");
				
				nowhtml= tagconvert(nowhtml, "<h4 class='text-center incard h4center'>","</h4>","가운데큰본문::");
				nowhtml= tagconvert(nowhtml, "<h5 class='text-center incard h5center'>","</h5>","가운데중간본문::");
				nowhtml= tagconvert(nowhtml, "<h6 class='text-center incard h6center'>","</h6>","가운데작은본문::");
				
				
				
				nowhtml= tagconvert(nowhtml, "<h4 class='text-right incard h4right'>","</h4>","오른쪽큰본문::");
				nowhtml= tagconvert(nowhtml, "<h5 class='text-right incard h5right'>","</h5>","오른쪽중간본문::");
				nowhtml= tagconvert(nowhtml, "<h6 class='text-right incard h5right'>","</h6>","오른쪽작은본문::");
				
				
				nowhtml= tagconvert(nowhtml, "<h6 class='incard h6'>","</h6>","작은본문::");
				nowhtml= tagconvert(nowhtml, "<h5 class='incard h5'>","</h5>","중간본문::");
				nowhtml= tagconvert(nowhtml, "<h4 class='incard h4'>","</h4>","큰본문::");
				nowhtml= nowhtml.replaceAll( "푸른시작버튼::","<button class='btn btn-info btn_next  '>시작하기</button>");
				nowhtml= nowhtml.replaceAll( "시작버튼::","<p class='text-center'><button class='btn btn-warning btn_next btn-block'>시작하기</button></p>");
				
				
				
				nowhtml= tagconvert(nowhtml, "<span class='float-right'>","</span>","오른쪽::");
				
				
				nowhtml=nowhtml.replaceAll("1분벨::","	<button class='btn btn-outline-warning' onclick='void(0);' id='btn_bell'>종소리</button><b id='b_nowtime' class='text-warning'></b>");
				
				
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup1.play();' style='display:none;' >","</button>","숨은다음버튼함께음악1시작::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup1.pause();' style='display:none;' >","</button>","숨은다음버튼함께음악1멈춤::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup2.play();' style='display:none;' >","</button>","숨은다음버튼함께음악2시작::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup2.pause();' style='display:none;' >","</button>","숨은다음버튼함께음악2멈춤::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup3.play();' style='display:none;' >","</button>","숨은다음버튼함께음악3시작::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup3.pause();' style='display:none;' >","</button>","숨은다음버튼함께음악3멈춤::");
				
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup1.play();'   >","</button>","다음버튼함께음악1시작::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup1.pause();'  >","</button>","다음버튼함께음악1멈춤::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup2.play();'  >","</button>","다음버튼함께음악2시작::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup2.pause();' >","</button>","다음버튼함께음악2멈춤::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup3.play();'   >","</button>","다음버튼함께음악3시작::");
				nowhtml=tagconvert(nowhtml,"<button type='submit'   class='btn btn-warning btn_next float-right' name='button'  onclick='aup3.pause();'  >","</button>","다음버튼함께음악3멈춤::");
				
				nowhtml=nowhtml.replaceAll("음악재생멈춤버튼::","<button class='btn btn-outline-warning  ' onclick='void(0);' id='btn_sermon'>일시 멈춤</button> ");
				
				
				if(nowhtml.indexOf("음악1설정::")>0) {
					
					var imsiSrc=nowhtml.split("음악1설정::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("음악1설정::"+imsiSrc,"");
					
				}
				
				if(nowhtml.indexOf("음악2설정::")>0) {
					
					var imsiSrc=nowhtml.split("음악2설정::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("음악2설정::"+imsiSrc,"");
					
				}
				if(nowhtml.indexOf("음악3설정::")>0) {
					
					var imsiSrc=nowhtml.split("음악3설정::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("음악3설정::"+imsiSrc,"");
					
				}
				
				
				
				
				nowhtml=pictureconverter(nowhtml);
				nowhtml=mediaconverter(nowhtml);
				
				if(nowhtml.indexOf("음악3설정::")>0) {
					
					var imsiMusicSrc=nowhtml.split("음악3설정::")[1].split("\n")[0];
					nowhtml=nowhtml.replaceAll("음악3설정::"+imsiMusicSrc,"");
					
					
				}
				
				if(nowhtml.indexOf("음악1멈춤::")>0) {
					
					nowhtml=nowhtml.replaceAll("음악1멈춤::","");
					
					
				}
				if(nowhtml.indexOf("음악3멈춤::")>0) {
					
					nowhtml=nowhtml.replaceAll("음악3멈춤::","");
					
					
				}
				if(nowhtml.indexOf("음악2멈춤::")>0) {
					
					nowhtml=nowhtml.replaceAll("음악2멈춤::","");
					
					
				}
				
				
				
				
				
				
				$('.maincard').eq(0).html(nowhtml).show();
				
				
				$('.linkbtn').each(function() {
					$(this).prop("href",$(this).text().split("|")[1]).text($(this).text().split("|")[0]);
				});
				
				$('.in_table_head').each(function() {
					console.log($(this).html());
					$(this).html(""+$(this).html().replaceAll("|","</th><th>")+" ");
					console.log($(this).html());
				});		
				
				
				$('.in_table_body').each(function() {
					console.log($(this).html());
					$(this).html($(this).html().replaceAll("|","</td>\n<td>")+"\n");
					console.log($(this).html());
				});	
				
				
				/*
					$(".incard").on('click',function() { 
					
					if($(this).next().hasClass('oneline')) {
					$(this).next().val($(this).html());
					$(this).next().focus();
					
					return;
					} 
					
					$('.oneline').detach();
					
					var today=new Date();
					
					var new_input_id=("inp"+today.getHours()+today.getMinutes()+today.getSeconds());
					
					var innertext_converted=$(this).html().replaceAll("<b class=\"colyel\">","[").replaceAll("</b>","]").replaceAll("<sub>","[[").replaceAll("</sub>","]]");
					
					
					
					$(this).after("<input type='text' value='"+innertext_converted+"' class='oneline' id='"+new_input_id+"'/>");
					onedit_obj=$(this);
					
					$(this).hide();
					
					$("#"+new_input_id).focus();
					
					
					
					$("#"+new_input_id).focusout(function() {
					$(this).prev().html($(this).val().replaceAll("[[","<sub>").replaceAll("]]","</sub>").replaceAll("[","<b class='colyel'>").replaceAll("]","</b>"));
					
					
					if($(this).prev().hasClass("h4")){
					
					rewrite_text("큰본문::",$(this).prev().data('cnt'),$(this).val());
					
					
					}
					$(this).detach();
					onedit_obj.show();
					
					
					});
					
					
					});
				*/
								
				
				setSildeTitle();
			});
			
			function rewrite_text(origintag,cnt,newval) {
				
				var imsitext2=$('#editor').val().split("\n"+origintag); //[number($(this).prev().data('cnt'))]
				var imsitext3=imsitext2[cnt].split("\n");
				imsitext3[0]=newval;
				imsitext2[cnt]=imsitext3.join("\n");
				$('#editor').val(imsitext2.join("\n"+origintag));
				
			}
			
			function tagconvert (fulltext, tag_start, tag_end,origintag) {
				var imsihtmltext=fulltext;
				var intag_content="";
				
				if(imsihtmltext.indexOf(origintag)==-1) return fulltext;
				var cnt=0;
				do {
					cnt++;
					
					intag_content=imsihtmltext.split(origintag)[1].split("\n")[0];
					
					imsihtmltext=imsihtmltext.replace(origintag+intag_content,tag_start.slice(0,-1)+" data-cnt='"+cnt+"'>"+intag_content+tag_end);
					if(cnt>100) break;
				} while (imsihtmltext.indexOf(origintag)>=0)
				
				return  imsihtmltext;
				
			}
			
			function mediaconverter(fulltext) {
				
				var imsihtmltext=fulltext;
				var intag_content="";
				var cnt=0;
				
				if(imsihtmltext.indexOf("유튜브::")==-1) return fulltext;
				
				/*
					do { 
					intag_content=imsihtmltext.split("흑백유튜브::")[1].split("\n")[0];
					
					imsihtmltext=imsihtmltext.replace("흑백유튜브::"+intag_content,"<div class='embed-responsive embed-responsive-16by9'><iframe id='if1'  class='embed-responsive-item' src='https://www.youtube.com/embed/"+intag_content+"' style='filter: grayscale(100%);'></iframe></div>");
					
					if(cnt++>100) break;
					} while (imsihtmltext.indexOf("흑백유튜브::")>=0)
				*/
				
				
				do { 
					intag_content=imsihtmltext.split("유튜브::")[1].split("\n")[0];
					
					imsihtmltext=imsihtmltext.replace("유튜브::"+intag_content,"<div class='embed-responsive embed-responsive-16by9'><iframe id='if1'  class='embed-responsive-item' src='https://www.youtube.com/embed/"+intag_content+"'></iframe></div>");
					
					if(cnt++>100) break;
				} while (imsihtmltext.indexOf("유튜브::")>=0)
				
				return  imsihtmltext;
				
				
			}
			
			function pictureconverter (fulltext) {
				var imsihtmltext=fulltext;
				var intag_content="";
				var cnt=0;
				
				if(imsihtmltext.indexOf("자료사진::")==-1) return fulltext;
				do { 
					intag_content=imsihtmltext.split("자료사진::")[1].split("\n")[0];
					
					imsihtmltext=imsihtmltext.replace("자료사진::"+intag_content,"<div class='text-center'><img src='"+intag_content+"'class='img-fluid ' alt='Responsive image' style='width:50%'/></div>");
					if(cnt++>100) break;
				} while (imsihtmltext.indexOf("자료사진::")>=0)
				
				return  imsihtmltext;
				//$imsilist2="<div class='text-center'><img src='$this_title'class='img-fluid ' alt='Responsive image' style='width:50%'/></div>".$imsilist2;
			}
			
			$('.onslide').click(function() { 
				var slideNum=$(this).data('sd');
				now_slide_number=slideNum;
				
				$('#editor').val(alldata.split("슬라이드::")[slideNum].replaceAll("\t",""));
				$('.onslide').removeClass('active');
				$(this).addClass('active');
				
				
				
				
				$('#btn_view').click();
				
				if(now_project_type=='묵상') {
					
					$('#btn_view_new_window').prop('href',viewer_address+"?room="+now_post_ID+"&page="+slideNum);
					
				} 
				if(now_project_type=='주보') {
					$('#btn_view_new_window').prop('href',viewer_address+"?n="+now_post_ID+"&page="+slideNum);
					
					
					if($('#editor').val().indexOf("?edit_pid=")>0)  $('#btn_project_edit_other').prop('href','../../img/form_all5.php?edit_pid='+$('#editor').val().split("?edit_pid=")[1].split("\n")[0])
					
					
					
				}
				if(now_project_type=='유인물') {
					$('#btn_view_new_window').prop('href',viewer_address+"?n="+now_post_ID+"/#/"+(slideNum-1));
					
					
					
				}
				if($('#editor').val().indexOf("단락전환시작::")>0) {
					
					
					$('#btn_change_div').show(); 
					
					} else {
					$('#btn_change_div').hide();
				}
				
				if($('#editor').val().indexOf("배경사진::")>0 && $('#editor').val().indexOf("컴퓨터배경::")>0) {
					
					
					$('#btn_change_bg').show(); 
					
					} else {
					$('#btn_change_bg').hide();
				}
				
				if($('#editor').val().indexOf("단락전환시작::")>0 || ($('#editor').val().indexOf("배경사진::")>0 && $('#editor').val().indexOf("컴퓨터배경::")>0)) {
					$('#btn_gr_change').show();
					
					} else{
					
					$('#btn_gr_change').hide();
					
				}
				
				//
				
				
			});
			
			
			function setSildeTitle() {
				var cnt=alldata.split("슬라이드::").length-1;
				
				
				//console.log(cnt);
				var imsi_bell=" ";
				
				last_slide_num=cnt;
				
				$('.onslide').removeClass("list-group-item-secondary");
				var i=1;
				var imsi_img_add="";
				$('.onslide').hide().addClass('noshow');
				
				
				for(i=1;i<=cnt;i++) {
					
					if(getPic(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0])!=="") {
						imsi_img_add="<img src='"+getPic(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0])+"' class='smallpic float-right'/>";
						
					}
					if(getPic_desktop(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0])!=="") {
						imsi_img_add+="<img src='"+getPic_desktop(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0])+"' class='smallpic float-right mr-1'/>";
						
					}
					
					//getPic_desktop  // 단락전환시작:: 
					imsi_bell="";
					
					//<i class='selicon bi-wrench'></i>
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("<script>")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-outline-danger btn mr-1'><i class='selicon bi-wrench'></i></button>";
						
					}
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("유튜브::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-outline-success btn mr-1'><i class='selicon bi-camera-reels'></i></button>";
						
					}
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("단락전환시작::")>0) { //  btn_change_div
						
						imsi_bell+=" <button class='btn-sm btn-outline-success btn mr-1'><i class='selicon bi-arrow-repeat'></i></button>";
						
					}
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("멈춤::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-outline-success btn mr-1'>	<i class='selicon bi-volume-mute-fill'></i></button>";
						
					}
					
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("1분벨::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-outline-success btn mr-1'><i class='selicon bi-bell-fill'></i></button>";
						
						
					}
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("음악1설정::")>0) {
						
						var imsiSrc=alldata.split("슬라이드::")[i].split("음악1설정::")[1].split("\n")[0];
						
						aup1.src=imsiSrc;
						
					}
					
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("음악1설정::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-warning btn mr-1 playbgm' data-toggle='tooltip' data-placement='top' title='음악1설정'  data-bgm='1'><i class='selicon bi-music-note-beamed'></i></button>";
						
					}
					
					
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("음악1시작::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-warning btn mr-1 playbgm' data-bgm='1'><i class='selicon bi-music-note-beamed'></i></button>";
						
					}
					
					
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("음악2시작::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-outline-success btn mr-1 playbgm' data-bgm='2' ><i class='selicon bi-music-note-beamed'></i></button>";
						
					}
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("음악3시작::")>0) {
						
						imsi_bell+=" <button class='btn-sm btn-outline-success btn mr-1 playbgm' data-bgm='3' ><i class='selicon bi-music-note-beamed'></i></button>";
						
					}
					
					
					//<i class='selicon bi-volume-up'></i>  숨은다음버튼함께음악1시작
					
					if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("제목::")>=0)  {
						
						
						$('.onslide').eq(i-1).html(imsi_img_add+i+"  <b>"+alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].split("제목::")[1].split("\n")[0].replaceAll("[","").replaceAll("]","").replaceAll("#","")+"</b>"+imsi_bell).show().removeClass('noshow');
						
						
						} else if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("\n# ")>=0)  {
						
						$('.onslide').eq(i-1).html(imsi_img_add+i+"  <b>"+alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].split("\n# ")[1].split("\n")[0].replaceAll("[","").replaceAll("]","").replaceAll("#","")+"</b>"+imsi_bell).show().removeClass('noshow');
						
						
						} else if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("\n## ")>=0)  {
						
						$('.onslide').eq(i-1).html(imsi_img_add+i+"  <b>"+alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].split("\n## ")[1].split("\n")[0].replaceAll("[","").replaceAll("]","").replaceAll("#","")+"</b>"+imsi_bell).show().removeClass('noshow');
						
						
						} else if(alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].indexOf("\n### ")>=0)  {
						
						$('.onslide').eq(i-1).html(imsi_img_add+i+"  <b>"+alldata.split("슬라이드::")[i].split("아래는메모사항::")[0].split("\n### ")[1].split("\n")[0].replaceAll("[","").replaceAll("]","").replaceAll("#","")+"</b>"+imsi_bell).show().removeClass('noshow');
						
						
						
						
						
						
						}else {
						
						
						$('.onslide').eq(i-1).html(imsi_img_add+i+" (제목없음) "+imsi_bell).show().removeClass('noshow');
						
						
						
					}
					
					
					
					
				}
				
				
				
			}
			
			function getPic(slidetext) {
				var picname="";
				if(slidetext.indexOf("배경사진::")>=0) {
					
					picname=slidetext.split("배경사진::")[1].split("\n")[0];
					} else {
					
					picname="";
				}
				return  picname
			}
			
			function getPic_desktop(slidetext) {
				var picname="";
				if(slidetext.indexOf("컴퓨터배경::")>=0) {
					
					picname=slidetext.split("컴퓨터배경::")[1].split("\n")[0];
					} else {
					
					picname="";
				}
				return  picname
			}
			
			$('#btn_load_db').click(function() {
				
				$.ajax({
					url: "./ajaxread.php",
					dataType: 'json',
					type:"GET",
					data: {
						postid:now_post_ID
						
					},
					success: function(data) {
						//console.log(data);
						alldata=data['post_content'];
						now_post_ID=data['ID'];
						now_post_title=data['post_title'];
						setSildeTitle();
						$('#now_title').text(now_post_title);
						
						$('.onslide').eq(now_slide_number-1).click();
						
						$('.onslide').removeClass('list-group-item-danger');
						
						
						
					}
				});	
				
				
				
				
			});
			
			$('#btn_load_project').click(function( ) {
				$('#div_projects').toggle();
				load_project_list();
				
			});
			
			
			function get_pic_from_project(contents,post_id) {
				
				//contents	if(getPic(contents.split("슬라이드::")[i])!=="") {
				var newpiclist=contents.split("슬라이드::").map((x,i)=>{ 
					if(x.indexOf("배경사진::")) return (x.split("배경사진::")[1]+"\n").split("\n")[0]; 
				}).filter(x=>{return  x!=="undefined"&& !!x; });
				
				return "<img class='smallpic proj_pic' data-postid='"+post_id+"' src='"+newpiclist.join("'/> <img  class='smallpic proj_pic' data-postid='"+post_id+"' src='")+"'/><div class='clearfix'></div>";
				
				
			}
			function load_project_list() {
				
				
				
				$.ajax({
					url: "./ajaxproject_list_40.php",
					dataType: 'json',
					type:"GET",
					data: {
						project_type:now_project_type
					},
					success: function(data) {
						var imsihtml="<table class='table table-hover table-striped'>";
						
						//console.log(data);
						project_list=data;
						project_list.forEach(x=> {
							//console.log(x.post_title);
							//						imsihtml=imsihtml+"<tr><td data-postid='" + x.ID + "' onclick='void(0)' class='protitle' > "+x.ID+" "+x.post_title+" <sub> "+x.post_modified+" </sub></td><td>"+ get_pic_from_project(x.post_content,x.ID)+"</td></tr>";
							
							if(x.post_title.includes("공용")) {
								imsihtml=imsihtml+"<tr class='bg-success'><td data-postid='" + x.ID + "' onclick='void(0)' class='protitle' > "+x.ID+" "+x.post_title+" <sub> "+x.post_modified+" </sub></td><td>"+ " "+"</td></tr>";
								} else {
								imsihtml=imsihtml+"<tr><td data-postid='" + x.ID + "' onclick='void(0)' class='protitle' > "+x.ID+" "+x.post_title+" <sub> "+x.post_modified+" </sub></td><td>"+ " "+"</td></tr>";
							}
							
							
						});
						imsihtml+="</table>";
						alertify.success("<kbd>Alt</kbd> + <kbd><i class=' bi-arrow-up'></i></kbd>,  <kbd><i class=' bi-arrow-down'></i></kbd><br> 단축키로 프로젝트간 이동이 가능합니다.");
						
						$('#div_projects').html(imsihtml);
						$('.protitle').click(function() {
							
							
							now_post_ID=$(this).data('postid');
							//alert(now_post_ID);
							load_first_db();
							$('#div_projects').hide();
							
							
							
						});
						
						
					}
				});	
				
				
			}
			
			
			
			
			function load_first_db_part(data) {  // 아직 미사용
				//console.log(data);
				alldata=data['post_content'];
				now_post_ID=data['ID'];
				now_post_title=data['post_title'];
				setSildeTitle();
				$('#now_title').text(now_post_title);
				
				$('.onslide').eq(now_slide_number-1).click();
				
				if(now_project_num>=alldata.split("슬라이드::").length) now_project_num=1;
				
				$('.onslide').removeClass('list-group-item-danger');
				
			}
			
			function load_first_db() {
				if(now_post_ID==0) return;
				//console.log("post id"+now_post_ID);
				
				$.ajax({
					url: "./ajaxread.php",
					dataType: 'json',
					type:"GET",
					data: {
						postid:now_post_ID
					},
					success: function(data) {
						//console.log(data);
						alldata=data['post_content'];
						now_post_ID=data['ID'];
						now_post_title=data['post_title'];
						setSildeTitle();
						$('#now_title').text(now_post_title);
						
						$('.onslide').eq(now_slide_number-1).click();
						
						if(now_project_num>=alldata.split("슬라이드::").length) now_project_num=1;
						
						$('.onslide').removeClass('list-group-item-danger');
						
					}
				});	
				
			}
			
			//now_post_ID
			function save_to_db_newpost() {
				
				
				
				
				alertify.prompt( '다른 이름 저장', '이름을 입력해 주세요. 이름에 온라인기도실 과 묵상이란 단어가 반드시 들어가야 합니다. [공용]이란 단어가 들어가면 관리자만 편집할 수 있으니 개별 교회 내용은 공용이란 단어를 넣지 마시기 바랍니다.', now_post_title,function(evt, value) { 
					
					title_new=value;
					console.log(title_new);
					
					
					$.ajax({
						url: "./create_new.php",
						dataType: 'json',
						type:"POST",
						data: {
							title:title_new,
							cont:alldata
							},success: function(data) {
							//console.log(data);
							now_post_ID=data.id;
							
							now_post_title=title_new;
							$('#now_title').text(now_post_title);
							
							
							alertify.set('notifier','position', 'top-center');
							alertify.success('저장되었습니다.');
							
							
						}
					});	
					
					
				}, function() { alertify.error('취소하셨습니다.') });
				
				
				
				
				
			}
			
			
			function save_to_db() {
				
				if(now_post_title.includes("공용") && now_user_wp_id!==1 ) {
					
					alertify.warning("공용 프로젝트는 관리자만 저장할 수 있습니다. 변경을 원할 경우 [복사 후 저장]으로 작업하시기 바랍니다");
					
					
					return;
					
				}
				
				
				$('.tog_edit').hide();
				
				if(now_post_ID==0) {
					save_to_db_newpost();
					return;
				}
				
				//now_user_wp_id
				$.ajax({
					url: "./ajaxwrite.php",
					dataType: 'json',
					type:"POST",
					data: {
						ID:now_post_ID,
						content:alldata
						},success: function(data) {
						//console.log(data);
						
						alertify.set('notifier','position', 'top-center');
						alertify.success('저장되었습니다.');
						if(now_project_type=='유인물') {
							$('#main_if').attr('src',viewer_address+"?making&n="+now_post_ID+"/#/"+(now_slide_number-1));
							
							if(last_saved_data!==JSON.stringify(alldata)) {
								last_saved_data=JSON.stringify(alldata);
								document.getElementById('main_if').contentDocument.location.reload(true);
							}
						}
						
					}
				});	
				
			}
			
			$('#btn_save_thisslide').click(function() {
				
				var imsi_slide=alldata.split("슬라이드::");
				
				imsi_slide[now_slide_number]=$('#editor').val();
				
				alldata=imsi_slide.join("슬라이드::")
				
				$('.onslide').eq(now_slide_number-1).addClass('list-group-item-danger');
				//console.log(now_slide_number);
				
				
				if(now_post_ID==0) alert("아직 불러온 슬라이드가 없습니다");
				
				$('#btn_view').click();	
				
				save_to_db();
				
				
			});
			
			$('#btn_save_db').click(function() {
				if(now_post_ID==0) alert("아직 불러온 슬라이드가 없습니다");
				save_to_db();
				//setSildeTitle();
				
				$('.onslide').removeClass('list-group-item-danger');
			});
			
			$(document).on("click",  "#btn_make_qr", function( event ){   
				var htmls="";
				var now_url=$('#btn_view_new_window').prop('href');
				
				//viewer_address+"?room="+now_post_ID+"&page="+now_slide_number
				
				url=encodeURIComponent(now_url);
				
				htmls+="<img src='http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=L|0&chl="+url+"' widthHeight='150'/>";	
				
				
				$('#div_qr').html(htmls);
				
				//console.log(htmls);
				$('#myModal2').modal();
				
				
				
				
			});
			
			function PrintTime() {   //2021 사순절 1분벨용
				aup1.loop=false;
				
				
				if(now_sec<=0 ) {
					$('#b_nowtime').text('다음을 누르세요');
					} else {
					$('#b_nowtime').text(now_sec--);
				}
			}
			
			
			
			
			
			$(document).on("click", "#btn_bell", function(event){
				aup1.play();
				timerId = setInterval(PrintTime, 1000);
				$('#btn_bell').hide();
				var fade_settimer_id=setTimeout("$('.btn_next').show('slow');",10000);
				setTimeout("clearInterval(timerId);",62000);
			});
			
			$(document).on("click", "#btn_sermon", function(event){
				if($(this).text()=='일시 멈춤') {
					aup2.pause();
					$(this).text('계속 듣기');
					} else {
					aup2.play();
					$(this).text('일시 멈춤');
				}
				
			});
			
			$(document).on("click", "#btn_add_slide", function(event){
				
				alldata+="\n슬라이드::";
				$('.noshow').eq(0).removeClass('noshow').text("새로운 슬라이드").show('slow');
				alertify.success('새로운 슬라이드가 추가되었습니다');
			});
			/*
				document.addEventListener('mousedown', function(e) {
				e.preventDefault();
				if ((event.button == 2) || (event.which == 3)) {
				alertify.success('오른쪽 마우스 버튼');
				}
				});
			*/
			$(document).on("click", "#btn_del_slide", function(event){
				var new_data=[];  
				
				for(i=1;i<=alldata.split("슬라이드::").length;i++) {
					if(now_slide_number!==i) new_data.push(alldata.split("슬라이드::")[i]);
					
				}
				console.log(now_slide_number);
				console.log(new_data.pop());
				alldata="슬라이드::"+new_data.join("슬라이드::");
				
				last_slide_num--;
				
				if(now_slide_number>last_slide_num)  now_slide_number=last_slide_num;
				$('.onslide').eq(now_slide_number-1).click();
				$('.onslide').eq(last_slide_num-1).addClass('noshow').hide();
				
				setSildeTitle();
				
				
				alertify.success('삭제했습니다.'); 
				
				
				}); /*
				$(document).on("click", "#btn_del_slide", function(event){
				var new_data=[];
				
				
				for(i=1;i<=alldata.split("슬라이드::").length;i++) {
				if(now_slide_number!==i) new_data.push(alldata.split("슬라이드::")[i]);
				
				}
				console.log(new_data.pop());
				alldata="슬라이드::"+new_data.join("슬라이드::");
				
				last_slide_num--;
				
				if(now_slide_number>last_slide_num)  now_slide_number=last_slide_num;
				$('.onslide').eq(now_slide_number-1).click();
				$('.onslide').eq(last_slide_num-1).addClass('noshow').hide();
				
				setSildeTitle();
				
				
				alertify.success('삭제했습니다.'); 
				
				
			});*/
			
			
			//	function add_tag(tag_start_str,tag_end_str) {
			function change_size_Tag() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="작은본문") { ischange=true; newval.push("중간본문"+now_sentence_cont); } 
				if(nowTag=="중간본문")  { ischange=true; newval.push("큰본문"+now_sentence_cont); }
				if(nowTag=="큰본문")  { ischange=true; newval.push("작은본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데작은본문") { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); } 
				if(nowTag=="가운데중간본문")  { ischange=true; newval.push("가운데큰본문"+now_sentence_cont); }
				if(nowTag=="가운데큰본문")  { ischange=true; newval.push("가운데작은본문"+now_sentence_cont);  }
				
				if(nowTag=="오른쪽작은본문") { ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽중간본문")  { ischange=true; newval.push("오른쪽큰본문"+now_sentence_cont); }
				if(nowTag=="오른쪽큰본문")  { ischange=true; newval.push("오른쪽작은본문"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n"));
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				
				get_now_tag();
				return;
				
				
				
			}
			
			
			function change_size_Tag_small() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="작은본문") return; // { ischange=true; newval.push("중간본문"+now_sentence_cont); } 
				if(nowTag=="중간본문")  { ischange=true; newval.push("작은본문"+now_sentence_cont); }
				if(nowTag=="큰본문")  { ischange=true; newval.push("작은본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데작은본문") return; // { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); } 
				if(nowTag=="가운데중간본문")  { ischange=true; newval.push("가운데작은본문"+now_sentence_cont); }
				if(nowTag=="가운데큰본문")  { ischange=true; newval.push("가운데작은본문"+now_sentence_cont);  }
				
				if(nowTag=="오른쪽작은본문") return; //{ ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽중간본문")  { ischange=true; newval.push("오른쪽작은본문"+now_sentence_cont); }
				if(nowTag=="오른쪽큰본문")  { ischange=true; newval.push("오른쪽작은본문"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				
				get_now_tag();
				return;
				
				
				
			}
			
			function change_size_Tag_middle() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="중간본문") return; // { ischange=true; newval.push("중간본문"+now_sentence_cont); } 
				if(nowTag=="작은본문")  { ischange=true; newval.push("중간본문"+now_sentence_cont); }
				if(nowTag=="큰본문")  { ischange=true; newval.push("중간본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데중간본문") return; // { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); } 
				if(nowTag=="가운데작은본문")  { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); }
				if(nowTag=="가운데큰본문")  { ischange=true; newval.push("가운데중간본문"+now_sentence_cont);  }
				
				if(nowTag=="오른쪽중간본문") return; //{ ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽작은본문")  { ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); }
				if(nowTag=="오른쪽큰본문")  { ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				
				get_now_tag();
				return;
				
				
				
			}
			
			function change_size_Tag_big() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="큰본문") return; // { ischange=true; newval.push("중간본문"+now_sentence_cont); } 
				if(nowTag=="작은본문")  { ischange=true; newval.push("큰본문"+now_sentence_cont); }
				if(nowTag=="중간본문")  { ischange=true; newval.push("큰본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데큰본문") return; // { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); } 
				if(nowTag=="가운데작은본문")  { ischange=true; newval.push("가운데큰본문"+now_sentence_cont); }
				if(nowTag=="가운데중간본문")  { ischange=true; newval.push("가운데큰본문"+now_sentence_cont);  }
				
				if(nowTag=="오른쪽큰본문") return; //{ ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽작은본문")  { ischange=true; newval.push("오른쪽큰본문"+now_sentence_cont); }
				if(nowTag=="오른쪽중간본문")  { ischange=true; newval.push("오른쪽큰본문"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				menu_icon_check(nowTag);
				
				
				return;
				
				
				
			}
			
			function change_align() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="작은본문") { ischange=true; newval.push("가운데작은본문"+now_sentence_cont); } 
				if(nowTag=="가운데작은본문")  { ischange=true; newval.push("오른쪽작은본문"+now_sentence_cont); }
				if(nowTag=="오른쪽작은본문")  { ischange=true; newval.push("작은본문"+now_sentence_cont);  }
				
				if(nowTag=="중간본문") { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); } 
				if(nowTag=="가운데중간본문")  { ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); }
				if(nowTag=="오른쪽중간본문")  { ischange=true; newval.push("중간본문"+now_sentence_cont);  }
				
				if(nowTag=="큰본문") { ischange=true; newval.push("가운데큰본문"+now_sentence_cont); } 
				if(nowTag=="가운데큰본문")  { ischange=true; newval.push("오른쪽큰본문"+now_sentence_cont); }
				if(nowTag=="오른쪽큰본문")  { ischange=true; newval.push("큰본문"+now_sentence_cont);  }
				
				if(nowTag=="제목") { ischange=true; newval.push("가운데제목"+now_sentence_cont); } 
				if(nowTag=="가운데제목")  { ischange=true; newval.push("오른쪽제목"+now_sentence_cont); }
				if(nowTag=="오른쪽제목")  { ischange=true; newval.push("제목"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				
				menu_icon_check(nowTag);
				return;
				
				
				
			}
			
			function change_align_left() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="가운데작은본문") { ischange=true; newval.push("작은본문"+now_sentence_cont); } 
				if(nowTag=="작은본문")  return;  
				if(nowTag=="오른쪽작은본문")  { ischange=true; newval.push("작은본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데중간본문") { ischange=true; newval.push("중간본문"+now_sentence_cont); } 
				if(nowTag=="중간본문") return;
				if(nowTag=="오른쪽중간본문")  { ischange=true; newval.push("중간본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데큰본문") { ischange=true; newval.push("큰본문"+now_sentence_cont); } 
				if(nowTag=="큰본문")  return;
				if(nowTag=="오른쪽큰본문")  { ischange=true; newval.push("큰본문"+now_sentence_cont);  }
				
				if(nowTag=="가운데제목") { ischange=true; newval.push("제목"+now_sentence_cont); } 
				if(nowTag=="제목")  return;
				if(nowTag=="오른쪽제목")  { ischange=true; newval.push("제목"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				menu_icon_check(nowTag);
				return;
				
			}
			
			
			
			
			function change_align_middle() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="작은본문") { ischange=true; newval.push("가운데작은본문"+now_sentence_cont); } 
				if(nowTag=="가운데작은본문")  return;
				if(nowTag=="오른쪽작은본문")  { ischange=true; newval.push("가운데작은본문"+now_sentence_cont);  }
				
				if(nowTag=="중간본문") { ischange=true; newval.push("가운데중간본문"+now_sentence_cont); } 
				if(nowTag=="가운데중간본문") return;
				if(nowTag=="오른쪽중간본문")  { ischange=true; newval.push("중간본문"+now_sentence_cont);  }
				
				if(nowTag=="큰본문") { ischange=true; newval.push("가운데큰본문"+now_sentence_cont); } 
				if(nowTag=="가운데큰본문")  return;
				if(nowTag=="오른쪽큰본문")  { ischange=true; newval.push("큰본문"+now_sentence_cont);  }
				
				if(nowTag=="제목") { ischange=true; newval.push("가운데제목"+now_sentence_cont); } 
				if(nowTag=="가운데제목")  return;
				if(nowTag=="오른쪽제목")  { ischange=true; newval.push("제목"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				menu_icon_check(nowTag);
				return;
				
			}
			
			function change_align_right() {
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0]
				var now_sentence_cont="::"+strOriginal.split("\n")[imsistr1.length-2].split("::")[1]; //	now_sentenceAll.split(nowTag)[1];
				console.log('sen: ' +now_sentence_cont);
				var ischange=false;
				if(nowTag=="작은본문") { ischange=true; newval.push("오른쪽작은본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽작은본문")  return;
				if(nowTag=="가운데작은본문")  { ischange=true; newval.push("오른쪽작은본문"+now_sentence_cont);  }
				
				if(nowTag=="중간본문") { ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽중간본문") return;
				if(nowTag=="가운데중간본문")  { ischange=true; newval.push("오른쪽중간본문"+now_sentence_cont);  }
				
				if(nowTag=="큰본문") { ischange=true; newval.push("오른쪽큰본문"+now_sentence_cont); } 
				if(nowTag=="오른쪽큰본문")  return;
				if(nowTag=="가운데큰본문")  { ischange=true; newval.push("오른쪽큰본문"+now_sentence_cont);  }
				
				if(nowTag=="제목") { ischange=true; newval.push("오른쪽제목"+now_sentence_cont); } 
				if(nowTag=="오른쪽제목")  return;
				if(nowTag=="가운데제목")  { ischange=true; newval.push("오른쪽제목"+now_sentence_cont);  }
				newval.push.apply(newval,imsistr2);
				
				
				console.log(newval);
				if(ischange) $('#editor').val(newval.join("\n")).focus();
				element.selectionStart=iStartPos;
				element.selectionEnd=iStartPos;
				$('#btn_view').click();	
				menu_icon_check(nowTag);
				return;
				
			}
			
			function get_now_tag() {
				
				
				var addString="\n"+$(this).text();
				console.log("ok");
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				//	console.log('start ' + iStartPos);
				
				var iEndPos = element.selectionEnd;
				
				
				var imsistr1=("\n"+strOriginal.substring(0,iStartPos)).split("\n");
				
				var imsistr2=(strOriginal.substring(iStartPos,strOriginal.length)).split("\n").reverse();  // 가장 앞쪽 배열 찌그러기 제거
				var imsi3=imsistr2.pop();
				imsistr2=imsistr2.reverse();
				//	console.log(imsistr2);
				
				var now_sentenceAll=strOriginal.split("\n")[imsistr1.length-2];
				
				//	console.log("nowtag = "+strOriginal.split("\n")[imsistr1.length-2]);
				
				
				var nowTag=("\n"+strOriginal.substring(0, iStartPos)).split("\n").pop().split("::")[0];
				//var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				var newval=[];
				
				for(i=0;i<imsistr1.length-2;i++) {
					newval.push(strOriginal.split("\n")[i]);
				}
				
				
				
				nowTag= strOriginal.split("\n")[imsistr1.length-2].split("::")[0];
				//console.log(nowTag);
				
				
				
				//	 btn_size_small btn_text_left btn_text_middle;
				return nowTag;
			}
			
			function menu_icon_check(nowTag) {
				
				$('.btn_menu_icon').removeClass('btn-dark').addClass('btn-light');
				if(nowTag.includes("오른쪽")) $('#btn_text_right').addClass('btn-dark').removeClass('btn-light');
				if(nowTag.includes("가운데")) $('#btn_text_middle').addClass('btn-dark').removeClass('btn-light');
				
				if(nowTag=="중간본문") $('#btn_text_left').addClass('btn-dark').removeClass('btn-light');
				if(nowTag=="작은본문") $('#btn_text_left').addClass('btn-dark').removeClass('btn-light');
				if(nowTag=="큰본문") $('#btn_text_left').addClass('btn-dark').removeClass('btn-light');
				
				if(nowTag.includes("중간본문")) $('#btn_size_middle').addClass('btn-dark').removeClass('btn-light');
				if(nowTag.includes("작은본문")) { $('#btn_size_small').addClass('btn-dark').removeClass('btn-light');}
				if(nowTag.includes("큰본문")) $('#btn_size_big').addClass('btn-dark').removeClass('btn-light');
				
				if(nowTag=="배경사진") $('#btn_modal_pic').addClass('btn-dark').removeClass('btn-light');	
				if(nowTag=="컴퓨터배경") $('#btn_modal_pic_desktop').addClass('btn-dark').removeClass('btn-light');	
				
				
			}
			
			$(document).on("click", ".snip", function(event){
				
				
				var addString="\n"+$(this).text();
				
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				var iEndPos = element.selectionEnd;
				var strFront = "";
				var strEnd = "";
				if(iStartPos == iEndPos) {
					strFront = strOriginal.substring(0, iStartPos);
					strEnd = strOriginal.substring(iStartPos, strOriginal.length);
				} else return;
				element.value = strFront + addString + strEnd
				
				element.selectionEnd=iEndPos+addString.length;
			});
			
			$(document).on("click", "#now_title", function(event){
				
				
				
				if(now_post_title.includes("공용") && now_user_wp_id!==1 ) {
					
					alertify.warning("공용 프로젝트는 관리자만 저장할 수 있습니다. 변경을 원할 경우 [복사 후 저장]으로 작업하시기 바랍니다");
					
					
					return;
					
				}
				
				alertify.prompt( '이름 변경', '새로운 이름을 입력해 주세요',now_post_title,function(evt, value) { 
					
					title_new=value;
					now_post_title=value;
					
					console.log(title_new);
					
					
					
					$.ajax({
						url: "./rename.php",
						dataType: 'json',
						type:"POST",
						data: {
							ID:now_post_ID,
							post_title:now_post_title
							},success: function(data) {
							console.log(data);
							
							alertify.set('notifier','position', 'top-center');
							alertify.success('새이름으로 저장되었습니다.');
							$('#now_title').text(now_post_title);
							
							
							
						}
					});	
					
					
				}, function() { alertify.error('취소하셨습니다.') });
			});
			
			
			function show_icon() {
				
				$('#div_icon_list').html("<i class='selicon bi-"+icon_list.join("'></i> <i class='selicon bi-")+"'></i>");
				
			}
			$(document).on("click", "#btn_sel_icon", function(event){
				
				
				$('.tog_edit_icon').toggle();
				
				
			});
			
			//playbgm
			$(document).on("click", ".playbgm", function(event){
				
				
				var bgm_number=$(this).data('bgm');
				if(isOnplay) {
					alertify.success('음악을 멈춥니다.');
				if(bgm_number=="1") aup1.pause();
		 
					
					if(bgm_number=="2") aup2.pause();
					if(bgm_number=="3") aup3.pause();
					
					
					} else {
			 
					alertify.success('음악을 재생합니다.');
					if(bgm_number=="1") aup1.play();
					
					if(bgm_number=="2") aup2.play();
					if(bgm_number=="3") aup3.play();
				}
				isOnplay=!isOnplay;
				
			});
			
			
			
			/*
				$(document).on("click", ".selicon", function(event){
				
				var element = document.getElementById('editor');
				var strOriginal = element.value;
				var iStartPos = element.selectionStart;
				
				
			var iEndPos = element.selectionEnd;
			
			
			
			
			
			var strFront=strOriginal.substring(0,iStartPos);
			var strEnd = strOriginal.substring(iStartPos, strOriginal.length);
			var tag="<i class='"+$(this).attr('class').replace("selicon","")+"'></i>";
			
			$('#editor').focus();
			
			element.value=strFront+tag+strEnd;
			element.selectionStart=strFront+tag.length;
			element.selectionEnd=strFront+tag.length;
			console.log('strfront'+strFront);
			
			
			
			});
			*/
			
			$(document).on("click", "#btn_change_div", function(event){
				
				if( $('.word_change').length==0) return;
				
				var now_word_div=$(this).data('change')-0;
				if($('#btn_change_div').data('change')>$('.word_change').length) now_word_div=0;
				
				
				
				$('#btn_sermon').hide();
				$('.btn_next').hide();
				$('.word_change').hide();
				$('.word_change').eq(now_word_div).show();
				
				
				now_word_div++;
				if($('.word_change').length==now_word_div) { 
					now_word_div=0;
					$('#btn_sermon').show();
					$('.btn_next').show();
				}
				$('#btn_change_div').data('change',now_word_div);
				
				console.log(now_word_div);
				
			});
			
			
			function next_project() {
				
				var imsi_slide=now_slide_number;
				
				project_list.forEach((x,i)=>{ 
					if(x.ID==now_post_ID-0) now_project_order=i;
				});
				now_project_order++;
				if(now_project_order>=project_list.length) now_project_order=0;
				now_post_ID=project_list[now_project_order].ID;
				load_first_db();
				
				menu_icon_check(get_now_tag());
				
			}
			
			function prev_project() {
				
				var imsi_slide=now_slide_number;
				
				project_list.forEach((x,i)=>{ 
					if(x.ID==now_post_ID-0) now_project_order=i;
				});
				
				now_project_order--;
				if(now_project_order<0) now_project_order=project_list.length-1;
				
				now_post_ID=project_list[now_project_order].ID;
				load_first_db();
				menu_icon_check(get_now_tag());
			}
			
			
			$('#editor').focus(function(){
				clearTimeout(timerId_kbd);
				menu_icon_check(get_now_tag());
				timerId_kbd=setTimeout("menu_icon_check(get_now_tag());",300);
				//console.log('focus'+get_now_tag()+'::');
			});
			
			$('#editor').click(function(){
				clearTimeout(timerId_kbd);
				menu_icon_check(get_now_tag());
				timerId_kbd=setTimeout("menu_icon_check(get_now_tag());",300);
				//console.log('focus'+get_now_tag()+'::');
			});
			
			function toggle_kbd_show() {
				
				if(timerId_kbd_event_on) return; 
				timerId_kbd_event_on=true;
				timerId_kbd=setTimeout("$('.ctrlk').show();$('.icont').hide();",200);
				
			}
			function toggle_kbd_hide() {
				timerId_kbd_event_on=false;
				
				clearTimeout(timerId_kbd);
				$('.altk').hide();
				$('.ctrlk').hide();
				$('.icont').show();
			}
			
			$(document).on("click", ".proj_pic", function(event){
				//alertify.success($(this).data('postid'));
				//	console.log($(this).prop('src')+" "+$(this).data('postid'));
				var new_to_sliden= project_list.filter(x=>x.ID==($(this).data('postid')-0))[0].post_content.split("슬라이드::").map((x,i)=>{ if(x.includes($(this).prop('src'))) return i;}).join("")-0;
				
				console.log('프로젝트번호'+$(this).data('postid')+' 슬라이드번호'+new_to_sliden);
				now_post_ID=$(this).data('postid');
				//alert(now_post_ID);
				now_slide_number=new_to_sliden;
				
				load_first_db();
				$('#div_projects').hide();
				
				
			});
			
			
			function make_btn_unsplash_userlist() {
				
				
				
				$('#undplash_user_list').html(unsplash_user_list.post_content.split("|").map(x=>"<a class='btn_unsplash_user_set ml-1 btn btn-sm btn-outline-success' data-un_username='"+x+"'>"+x+"</a>"))
			}
			$(document).on("click", ".btn_unsplash_user_set", function(event){
				unsplash_now_username=$(this).data('un_username');
				
				load_users_collection_list(unsplash_now_username);
				
			});
			
			
			function save_to_db_unsplash() {
				
				if(unsplash_user_list.post_content.indexOf(unsplash_now_username)>=0) return;
				
				unsplash_user_list.post_content+="|"+unsplash_now_username;
				
				$.ajax({
					url: "./add_unsplash.php",
					dataType: 'json',
					type:"POST",
					data: {
						ID:unsplash_user_list.ID,
						content:unsplash_user_list.post_content
						},success: function(data) {
						
						
						alertify.success('새로운 Unsplash 사용자가 저장되었습니다.');
						
						make_btn_unsplash_userlist();
					}
				});	
				
			}
			
			
			
			function get_data_from_googleform(form_url) {
				
				
				
				$.ajax({
					url: "./getform.php",
					dataType: 'json',
					type:"POST",
					data: {
						url:form_url
						},success: function(data) {
						
						
						//	alertify.success('새로운 Unsplash 사용자가 저장되었습니다.');
						console.log(data);
						if(data.code==200) {
							google_formdata=data;
							} else { //error
							
							
						}
						
					},
					error:function(req,stat,err) {
						//err code
					}
				});	
				
			}
			
			
			$(document).on("click", "#btn_project_publish", function(event){
				
				
				
				
				$('.tog_edit').hide();
				
				if(now_post_ID==0) {
					alertify.error("<span class='text-white'>먼저 저장후 발행하셔야 합니다</span>");
					
					save_to_db_newpost();
					return;
				}
				
				$.ajax({
					url: "./ajaxwrite.php",
					dataType: 'json',
					type:"POST",
					data: {
						ID:1167,
						content:alldata
						},success: function(data) {
						
						console.log(data);
						
						alertify.set('notifier','position', 'top-center');
						alertify.success('주보가 발행되었습니다. 발행한 주보를 반드시 확인하시기 바랍니다.');
						
						
						
						
					}
				});	
				
				
			});
			
			
			function rename_post() {
				
				$.ajax({
					url: "./rename.php",
					dataType: 'json',
					type:"POST",
					data: {
						ID:now_post_ID,
						post_title:now_post_title
						},success: function(data) {
						console.log(data);
						
						alertify.set('notifier','position', 'top-center');
						alertify.success('새이름으로 저장되었습니다.');
						$('#now_title').text(now_post_title);
						
						
						
					}
				});	
				
			}
			
			//======================================
			var alltag_data=[];
			
						
			//	$(document).on("click", '#btn_project_edit_other',function (data) {	
			//	if($('#editor').val().indexOf("?edit_pid")>0)  $('#btn_project_edit_other').prop('href','../../img/form_all5.php?'+$('#editor').val().split("?edit_pid")[1].split("\n")[0])
			
			
			
			
			//	});
			
			
			function load_bgmlist() {
			var imsi_bgm_html="";
			imsi_bgm_html="<h4>배경음악 목록</h4>";
			imsi_bgm_html+="<p>아래 음악목록을 이용해 기도실에 넣으실 수 있습니다. 제목을 누르면 음악을 설정합니다. 아래 목록 외에도 음악파일 주소가 있으면 자유롭게 넣으실 수 있습니다.</p>"
			bgmList.forEach((x,i)=>{
			var imsi_bgm_item=x.split("|");
			var imsi_play_btn="";

			imsi_play_btn+="<button class='btn btn-sm m-1 btn-warning float-right' onclick='aup0.pause()'>멈춤</button>";

			imsi_play_btn+="<button class='btn btn-sm m-1 btn-warning float-right btn_play_sample' onclick='void(0);' data-bgsrc='"+imsi_bgm_item[1] +"'>재생</button>";
			
			

			imsi_bgm_html+="<h4><a class='a_bgmlist' onclick='void(0);' data-bgsrc='"+imsi_bgm_item[1]+"'><i>"+imsi_bgm_item[0]+"</i></a>"+imsi_play_btn+"</h4>"+imsi_bgm_item[1]+"<br>";
			imsi_bgm_html+=imsi_bgm_item[2]+" "+imsi_bgm_item[3]+" "+imsi_bgm_item[4]+ " ("+imsi_bgm_item[5]+")";
			imsi_bgm_html+="<hr>";
			
			
			});
			
			//div_bgm_list
			$('#div_bgm_list').html(imsi_bgm_html);
			
			}

			
			$(document).on("click", '.btn_play_sample',function (data) { 
					
				
				aup0.src=$(this).data('bgsrc');
				aup0.play();

				alertify.success('음악을 재생합니다.');
				

			
			});

			
			$('#btn_sel_music').click(function () {
				load_bgmlist();

				$('#div_bgm_list').toggle();
				aup0.pause();
				aup1.pause();
				aup2.pause();
				aup3.pause();
				
				
			});
			
			
				$(document).on("click",".a_bgmlist",function(event) {
				//$('.selbg').click(function () {
				
				
				var nowhtml=$('#editor').val();
				
				var nowhtml_bgm="";
				var new_pic=$(this).data('bgsrc');
				
			 
				var basic_bg="음악1설정::";
				
				if(nowhtml.split(basic_bg).length>1) {
					
					nowhtml_pic=nowhtml.split(basic_bg)[1].split("\n")[0];
					nowhtml=nowhtml.replace(basic_bg+nowhtml_pic,basic_bg+new_pic);
					
					$('#editor').val(nowhtml);
						alertify.success('음악1을 변경하였습니다.');
					} else {
					
					nowhtml="\n"+basic_bg+new_pic+"\n"+nowhtml;
					$('#editor').val(nowhtml);
					alertify.success('음악1을 추가합니다. ');
					
				}
				aup0.pause();
				aup1.pause();
				aup2.pause();
				aup3.pause();
				$('#div_bgm_list').toggle();
				 
				 //div_alert  
				
				if(!alldata.includes("다음버튼함께음악1시작::")) {
				
				$('#div_alert').show();
				
				
				} else {
				$('#div_alert').hide();
				}
				
				 
				 
				 
				 
				
			});
			
			$(document).on("click","#u_add_playmusic",function(event) {
			$('#div_alert').hide('slow');
			var nowhtml=$('#editor').val()+"\n\n다음버튼함께음악1시작::다음\n";
			$('#editor').val(nowhtml);
			
			//
			});
			
			
		</script>
		
	</body>
</html>

